<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Python for Humanities: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Carpentries Incubator" src="../assets/images/incubator-logo.svg"><abbr class="badge badge-light" title="This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback." style="background-color: #FFC700; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#field-testing-alpha-stage" class="external-link alert-link" style="color: #383838">
            <i aria-hidden="true" class="icon" data-feather="alert-triangle" style="border-radius: 5px"></i>
            Alpha
          </a>
          <span class="visually-hidden">This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Python for Humanities
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Python for Humanities
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html"></a></li>
          </ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Python for Humanities
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-short-introduction-to-Python.html">1. Short Introduction to Programming in Python</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-starting-with-data.html">2. Starting With Data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="02-index-slice-subset.html">3. Indexing, Slicing and Subsetting DataFrames in Python</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="03-data-types-and-format.html">4. Data Types and Formats</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="04-merging-data.html">5. Combining DataFrames with pandas</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="05-loops-and-functions.html">6. Data workflows and automation</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="06-visualization-ggplot-python.html">7. Plotting with bokeh</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="07-putting-it-all-together.html">8. Data Ingest &amp; Visualization - Matplotlib &amp; Pandas</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="08-working-with-sql.html">9. Accessing SQLite Databases Using Python &amp; Pandas</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html"></a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-00-short-introduction-to-Python"><p>Content from <a href="00-short-introduction-to-Python.html">Short Introduction to Programming in Python</a></p>
<hr>
<p>Last updated on 2024-02-13 |
        
        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/00-short-introduction-to-Python.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is Python?</li>
<li>Why should I learn Python?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the advantages of using programming vs. completing
repetitive tasks by hand.</li>
<li>Define the following data types in Python: strings, integers, and
floats.</li>
<li>Perform mathematical operations in Python using basic
operators.</li>
<li>Define the following as it relates to Python: lists, tuples, and
dictionaries.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="the-basics-of-python"><h2 class="section-heading">The Basics of Python<a class="anchor" aria-label="anchor" href="#the-basics-of-python"></a>
</h2>
<hr class="half-width">
<p>Python is a general purpose programming language that supports rapid
development of scripts and applications.</p>
<p>Python’s main advantages:</p>
<ul>
<li>Open Source software, supported by Python Software Foundation</li>
<li>Available on all platforms</li>
<li>It is a general-purpose programming language</li>
<li>Supports multiple programming paradigms</li>
<li>Very large community with a rich ecosystem of third-party
packages</li>
</ul></section><section id="interpreter"><h2 class="section-heading">Interpreter<a class="anchor" aria-label="anchor" href="#interpreter"></a>
</h2>
<hr class="half-width">
<p>Python is an interpreted language which can be used in two ways:</p>
<ul>
<li>“Interactive” Mode: It functions like an “advanced calculator”
Executing one command at a time:</li>
</ul>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>user:host:<span class="op">~</span>$ python</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Python <span class="fl">3.5.1</span> (default, Oct <span class="dv">23</span> <span class="dv">2015</span>, <span class="dv">18</span>:<span class="dv">0</span><span class="er">5</span>:<span class="dv">0</span><span class="er">6</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>[GCC <span class="fl">4.8.3</span>] on linux2</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Type <span class="st">"help"</span>, <span class="st">"copyright"</span>, <span class="st">"credits"</span> <span class="kw">or</span> <span class="st">"license"</span> <span class="cf">for</span> more information.</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="st">"Hello World"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>Hello World</span></code></pre>
</div>
<ul>
<li>“Scripting” Mode: Executing a series of “commands” saved in text
file, usually with a <code>.py</code> extension after the name of your
file:</li>
</ul>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">user:host:~$</span> python my_script.py</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Hello</span> World</span></code></pre>
</div>
</section><section id="introduction-to-python-built-in-data-types"><h2 class="section-heading">Introduction to Python built-in data types<a class="anchor" aria-label="anchor" href="#introduction-to-python-built-in-data-types"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="strings-integers-and-floats">Strings, integers and floats<a class="anchor" aria-label="anchor" href="#strings-integers-and-floats"></a>
</h3>
<p>Python has built-in numeric types for integers, floats, and complex
numbers. Strings are a built-in textual type.:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">"Data Carpentry"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>number <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>pi_value <span class="op">=</span> <span class="fl">3.1415</span></span></code></pre>
</div>
<p>Here we’ve assigned data to variables, namely <code>text</code>,
<code>number</code> and <code>pi_value</code>, using the assignment
operator <code>=</code>. The variable called <code>text</code> is a
string which means it can contain letters and numbers. Notice that in
order to define a string you need to have quotes around your text. To
print out the value stored in a variable we can simply type the name of
the variable into the interpreter:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> text</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">"Data Carpentry"</span></span></code></pre>
</div>
<p>However, in a script, a <code>print</code> function is needed to
output the <code>text</code>:</p>
<p><em>example.py</em></p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A Python script file</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments in Python start with #</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The next line uses the print function to print out the text string</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(text)</span></code></pre>
</div>
<p><em>Running the script</em></p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> python example.py</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Data</span> Carpentry</span></code></pre>
</div>
<p><strong>Tip</strong>: The <code>print</code> function is a built-in
function in Python. Later in this lesson, we will introduce methods and
user-defined functions. The Python documentation is excellent for
reference on the differences between them.</p>
</div>
<div class="section level3">
<h3 id="operators">Operators<a class="anchor" aria-label="anchor" href="#operators"></a>
</h3>
<p>We can perform mathematical calculations in Python using the basic
operators <code>+, -, /, *, %</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span>   <span class="co">#  addition</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">6</span> <span class="op">*</span> <span class="dv">7</span>   <span class="co">#  multiplication</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="dv">42</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">2</span> <span class="op">**</span> <span class="dv">16</span>  <span class="co"># power</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="dv">65536</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">13</span> <span class="op">%</span> <span class="dv">5</span>  <span class="co"># modulo</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span></span></code></pre>
</div>
<p>We can also use comparison and logic operators:
<code>&lt;, &gt;, ==, !=, &lt;=, &gt;=</code> and statements of identity
such as <code>and, or, not</code>. The data type returned by this is
called a <em>boolean</em>.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">3</span> <span class="op">&gt;</span> <span class="dv">4</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="va">False</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="va">True</span> <span class="kw">and</span> <span class="va">True</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="va">True</span> <span class="kw">or</span> <span class="va">False</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="va">True</span></span></code></pre>
</div>
</div>
</section><section id="sequential-types-lists-and-tuples"><h2 class="section-heading">Sequential types: Lists and Tuples<a class="anchor" aria-label="anchor" href="#sequential-types-lists-and-tuples"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="lists">Lists<a class="anchor" aria-label="anchor" href="#lists"></a>
</h3>
<p><strong>Lists</strong> are a common data structure to hold an ordered
sequence of elements. Each element can be accessed by an index. Note
that Python indexes start with 0 instead of 1:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> numbers <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> numbers[<span class="dv">0</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span></code></pre>
</div>
<p>A <code>for</code> loop can be used to access the elements in a list
or other Python data structure one at a time:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> num <span class="kw">in</span> numbers:</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>...     <span class="bu">print</span>(num)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span></code></pre>
</div>
<p><strong>Indentation</strong> is very important in Python. Note that
the second line in the example above is indented. Just like three
chevrons <code>&gt;&gt;&gt;</code> indicate an interactive prompt in
Python, the three dots <code>...</code> are Python’s prompt for multiple
lines. This is Python’s way of marking a block of code. [Note: you do
not type <code>&gt;&gt;&gt;</code> or <code>...</code>.]</p>
<p>To add elements to the end of a list, we can use the
<code>append</code> method. Methods are a way to interact with an object
(a list, for example). We can invoke a method using the dot
<code>.</code> followed by the method name and a list of arguments in
parentheses. Let’s look at an example using <code>append</code>:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> numbers.append(<span class="dv">4</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(numbers)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span></code></pre>
</div>
<p>To find out what methods are available for an object, we can use the
built-in <code>help</code> command:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>(numbers)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>Help on <span class="bu">list</span> <span class="bu">object</span>:</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> <span class="bu">list</span>(<span class="bu">object</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a> <span class="op">|</span>  <span class="bu">list</span>() <span class="op">-&gt;</span> new empty <span class="bu">list</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a> <span class="op">|</span>  <span class="bu">list</span>(iterable) <span class="op">-&gt;</span> new <span class="bu">list</span> initialized <span class="im">from</span> iterable<span class="st">'s items</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="er"> ...</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="tuples">Tuples<a class="anchor" aria-label="anchor" href="#tuples"></a>
</h3>
<p>A tuple is similar to a list in that it’s an ordered sequence of
elements. However, tuples can not be changed once created (they are
“immutable”). Tuples are created by placing comma-separated values
inside parentheses <code>()</code>.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tuples use parentheses</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>a_tuple<span class="op">=</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>another_tuple <span class="op">=</span> (<span class="st">'blue'</span>, <span class="st">'green'</span>, <span class="st">'red'</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: lists use square brackets</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>a_list <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span></code></pre>
</div>
<div id="challenge---tuples" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---tuples" class="callout-inner">
<h3 class="callout-title">Challenge - Tuples<a class="anchor" aria-label="anchor" href="#challenge---tuples"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>What happens when you type <code>a_tuple[2]=5</code> vs
<code>a_list[1]=5</code> ?</li>
<li>Type <code>type(a_tuple)</code> into python - what is the object
type?</li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="dictionaries"><h2 class="section-heading">Dictionaries<a class="anchor" aria-label="anchor" href="#dictionaries"></a>
</h2>
<hr class="half-width">
<p>A <strong>dictionary</strong> is a container that holds pairs of
objects - keys and values.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> translation <span class="op">=</span> {<span class="st">'one'</span>: <span class="dv">1</span>, <span class="st">'two'</span>: <span class="dv">2</span>}</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> translation[<span class="st">'one'</span>]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span></code></pre>
</div>
<p>Dictionaries work a lot like lists - except that you index them with
<em>keys</em>. You can think about a key as a name for or a unique
identifier for a set of values in the dictionary. Keys can only have
particular types - they have to be “hashable”. Strings and numeric types
are acceptable, but lists aren’t.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rev <span class="op">=</span> {<span class="dv">1</span>: <span class="st">'one'</span>, <span class="dv">2</span>: <span class="st">'two'</span>}</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rev[<span class="dv">1</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">'one'</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> bad <span class="op">=</span> {[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]: <span class="dv">3</span>}</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  File <span class="st">"&lt;stdin&gt;"</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="pp">TypeError</span>: unhashable <span class="bu">type</span>: <span class="st">'list'</span></span></code></pre>
</div>
<p>In Python, a “Traceback” is an multi-line error block printed out for
the user.</p>
<p>To add an item to the dictionary we assign a value to a new key:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rev <span class="op">=</span> {<span class="dv">1</span>: <span class="st">'one'</span>, <span class="dv">2</span>: <span class="st">'two'</span>}</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rev[<span class="dv">3</span>] <span class="op">=</span> <span class="st">'three'</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rev</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>{<span class="dv">1</span>: <span class="st">'one'</span>, <span class="dv">2</span>: <span class="st">'two'</span>, <span class="dv">3</span>: <span class="st">'three'</span>}</span></code></pre>
</div>
<p>Using <code>for</code> loops with dictionaries is a little more
complicated. We can do this in two ways:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> key, value <span class="kw">in</span> rev.items():</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>...     <span class="bu">print</span>(key, <span class="st">'-&gt;'</span>, value)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> one</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> two</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> three</span></code></pre>
</div>
<p>or</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> key <span class="kw">in</span> rev.keys():</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>...     <span class="bu">print</span>(key, <span class="st">'-&gt;'</span>, rev[key])</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> one</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> two</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> three</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span></code></pre>
</div>
<div id="challenge---can-you-do-reassignment-in-a-dictionary" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---can-you-do-reassignment-in-a-dictionary" class="callout-inner">
<h3 class="callout-title">Challenge - Can you do reassignment in a
dictionary?<a class="anchor" aria-label="anchor" href="#challenge---can-you-do-reassignment-in-a-dictionary"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>First check what <code>rev</code> is right now (remember
<code>rev</code> is the name of our dictionary).</li>
</ol>
<p>Type:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rev</span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li><p>Try to reassign the second value (in the <em>key value pair</em>)
so that it no longer reads “two” but instead reads
“apple-sauce”.</p></li>
<li><p>Now display <code>rev</code> again to see if it has
changed.</p></li>
</ol>
</div>
</div>
</div>
<p>It is important to note that dictionaries are “unordered” and do not
remember the sequence of their items (i.e. the order in which key:value
pairs were added to the dictionary). Because of this, the order in which
items are returned from loops over dictionaries might appear random and
can even change with time.</p>
</section><section id="functions"><h2 class="section-heading">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<hr class="half-width">
<p>Defining a section of code as a function in Python is done using the
<code>def</code> keyword. For example a function that takes two
arguments and returns their sum can be defined as:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_function(a, b):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> a <span class="op">+</span> b</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> add_function(<span class="dv">20</span>, <span class="dv">22</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(z)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="dv">42</span></span></code></pre>
</div>
<p>Key points about functions are:</p>
<ul>
<li>definition starts with <code>def</code>
</li>
<li>function body is indented</li>
<li>
<code>return</code> keyword precedes returned value</li>
</ul></section></section><section id="aio-01-starting-with-data"><p>Content from <a href="01-starting-with-data.html">Starting With Data</a></p>
<hr>
<p>Last updated on 2024-02-13 |
        
        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/01-starting-with-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I import data in Python?</li>
<li>What is Pandas?</li>
<li>Why should I use Pandas to work with data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Navigate the workshop directory and download a dataset.</li>
<li>Explain what a library is and what libraries are used for.</li>
<li>Describe what the Python Data Analysis Library (Pandas) is.</li>
<li>Load the Python Data Analysis Library (Pandas).</li>
<li>Use <code>read_csv</code> to read tabular data into Python.</li>
<li>Describe what a DataFrame is in Python.</li>
<li>Access and summarize data stored in a DataFrame.</li>
<li>Define indexing as it relates to data structures.</li>
<li>Perform basic mathematical operations and summary statistics on data
in a Pandas DataFrame.</li>
<li>Create simple plots.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="working-with-pandas-dataframes-in-python"><h2 class="section-heading">Working With Pandas DataFrames in Python<a class="anchor" aria-label="anchor" href="#working-with-pandas-dataframes-in-python"></a>
</h2>
<hr class="half-width">
<p>We can automate the processes listed above using Python. It is
efficient to spend time building code to perform these tasks because
once it is built, we can use our code over and over on different
datasets that share a similar format. This makes our methods easily
reproducible. We can also share our code with colleagues so they can
replicate our analysis.</p>
<div class="section level4">
<h4 id="starting-in-the-same-spot">Starting in the same spot<a class="anchor" aria-label="anchor" href="#starting-in-the-same-spot"></a>
</h4>
<p>To help the lesson run smoothly, let’s ensure everyone is in the same
directory. This should help us avoid path and file name issues. At this
time please navigate to the workshop directory. If you working in
IPython Notebook be sure that you start your notebook in the workshop
directory.</p>
<p>A quick aside that there are Python libraries like <a href="https://docs.python.org/3/library/os.html" class="external-link">OS Library</a> that can
work with our directory structure, however, that is not our focus
today.</p>
</div>
<div class="section level4">
<h4 id="alexs-processing">Alex’s Processing<a class="anchor" aria-label="anchor" href="#alexs-processing"></a>
</h4>
<p>Alex is a researcher who is interested in Early English books. Alex
knows the EEBO dataset and refers to it to find data such as titles,
places, and authors. As well as searching for titles, they want to
create some exploratory plots and intermediate datasets.</p>
<p>Alex can do some of this work using spreadsheet systems but this can
be time consuming to do and revise. It can lead to mistakes that are
hard to detect.</p>
<p>The next steps show how Python can be used to automate some of the
processes.</p>
<p>As a result of creating Python scripts, the data can be re-run in the
future.</p>
</div>
<div class="section level4">
<h4 id="our-data">Our Data<a class="anchor" aria-label="anchor" href="#our-data"></a>
</h4>
<p>For this lesson, we will be using the EEBO catalogue data, a subset
of the data from EEBO/TCP <a href="https://eebo.chadwyck.com/home" class="external-link">Early
English Books Online/Text Creation Partnership</a></p>
<p>We will be using files from the data folder. This section will use
the <code>eebo.csv</code> file that can be found in your data
folder.</p>
<p>We are studying the authors and titles published marked up by the
Text Creation Partnership. The dataset is stored as a comma separated
(<code>.csv</code>) file, where each row holds information for a single
title, and the columns represent diferent aspects (variables) of each
entry:</p>
<table class="table">
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>TCP</td>
<td>TCP identity</td>
</tr>
<tr class="even">
<td>EEBO</td>
<td>EEBO identity</td>
</tr>
<tr class="odd">
<td>VID</td>
<td>VID identity</td>
</tr>
<tr class="even">
<td>STC</td>
<td>STC identity</td>
</tr>
<tr class="odd">
<td>status</td>
<td>Whether the book is free or not</td>
</tr>
<tr class="even">
<td>Author</td>
<td>Author(s)</td>
</tr>
<tr class="odd">
<td>Date</td>
<td>Date of publication</td>
</tr>
<tr class="even">
<td>Title</td>
<td>The Book title</td>
</tr>
<tr class="odd">
<td>Terms</td>
<td>Terms associated with the text</td>
</tr>
<tr class="even">
<td>Page Count</td>
<td>Number of pages in the text</td>
</tr>
<tr class="odd">
<td>Place</td>
<td>Location where the work was published</td>
</tr>
</tbody>
</table>
<p>If we open the <code>eebo.csv</code> data file using a text editor,
the first few rows of our first file look like this:</p>
<pre><code>TCP,EEBO,VID,STC,Status,Author,Date,Title,Terms,Page Count,Place
A00002,99850634,15849,STC 1000.5; ESTC S115415,Free,"Aylett, Robert, 1583-1655?",1625,"The brides ornaments viz. fiue meditations, morall and diuine. 1. Knowledge, 2. zeale, 3. temperance, 4. bountie, 5. ioy.",,134,London
A00005,99842408,7058,STC 10000; ESTC S106695,Free,"Higden, Ranulf, d. 1364. Polycronicon. English. Selections.; Trevisa, John, d. 1402.",1515,Here begynneth a shorte and abreue table on the Cronycles ...; Saint Albans chronicle.,Great Britain -- History -- To 1485 -- Early works to 1800.; England -- Description and travel -- Early works to 1800.,302,London
A00007,99844302,9101,STC 10002; ESTC S108645,Free,"Higden, Ranulf, d. 1364. Polycronicon.",1528,"The Cronycles of Englonde with the dedes of popes and emperours, and also the descripcyon of Englonde; Saint Albans chronicle.",Great Britain -- History -- To 1485 -- Early works to 1800.; England -- Description and travel -- Early works to 1800.,386,London
A00008,99848896,14017,STC 10003; ESTC S113665,Free,"Wood, William, fl. 1623, attributed name.",1623,Considerations vpon the treaty of marriage between England and Spain,Great Britain -- Foreign relations -- Spain.,14,The Netherlands?
A00011,99837000,1304,STC 10008; ESTC S101178,Free,,1640,"Englands complaint to Iesus Christ, against the bishops canons of the late sinfull synod, a seditious conuenticle, a packe of hypocrites, a sworne confederacy, a traiterous conspiracy ... In this complaint are specified those impieties and insolencies, which are most notorious, scattered through the canons and constitutions of the said sinfull synod. And confuted by arguments annexed hereunto.",Church of England. -- Thirty-nine Articles -- Controversial literature.; Canon law -- Early works to 1800.,54,Amsterdam
A00012,99853871,19269,STC 1001; ESTC S118664,Free,"Aylett, Robert, 1583-1655?",1623,"Ioseph, or, Pharoah's fauourite; Joseph.",Joseph -- (Son of Jacob) -- Early works to 1800.,99,London
A00014,33143147,28259,STC 10011.6; ESTC S3200,Free,,1624,Greate Brittaines noble and worthy councell of warr,"England and Wales. -- Privy Council -- Portraits.; Great Britain -- History -- James I, 1603-1625.; Broadsides -- London (England) -- 17th century.",1,London
A00015,99837006,1310,STC 10011; ESTC S101184,Free,"Jones, William, of Usk.",1607,"Gods vvarning to his people of England By the great ouer-flowing of the vvaters or floudes lately hapned in South-wales and many other places. Wherein is described the great losses, and wonderfull damages, that hapned thereby: by the drowning of many townes and villages, to the vtter vndooing of many thousandes of people.",Floods -- Wales -- Early works to 1800.,16, London
A00018,99850740,15965,STC 10015; ESTC S115521,Free,,1558,The lame[n]tacion of England; Lamentacion of England.,"Great Britain -- History -- Mary I, 1553-1558 -- Early works to 1800.",26,Germany?</code></pre>
<hr>
</div>
<div class="section level3">
<h3 id="about-libraries">About Libraries<a class="anchor" aria-label="anchor" href="#about-libraries"></a>
</h3>
<p>A library in Python contains a set of tools (functions) that perform
different actions on our data. Importing a library is like getting a set
of particular tools out of a storage locker and setting them up on the
bench for use in a project. Once a library is set up, its functions can
be used or called to perform different tasks.</p>
</div>
<div class="section level3">
<h3 id="pandas-in-python">Pandas in Python<a class="anchor" aria-label="anchor" href="#pandas-in-python"></a>
</h3>
<p>One of the best options for working with tabular data in Python is to
use the <a href="https://pandas.pydata.org/" class="external-link">Python Data Analysis
Library</a> (a.k.a. Pandas Library). The Pandas library provides
structures to sort our data, can produce high quality plots in
conjunction with other libraries such as <a href="https://matplotlib.org/" class="external-link">matplotlib</a>, and integrates nicely
with libraries that use <a href="https://www.numpy.org/" class="external-link">NumPy</a>
(which is another common Python library) arrays.</p>
<p>Python doesn’t load all of the libraries available to it by default.
We have to add an <code>import</code> statement to our code in order to
use library functions required for our project. To import a library, we
use the syntax <code>import libraryName</code>, where
<code>libraryName</code> represents the name of the specific library we
want to use. Note that the <code>import</code> command calls a library
that has been installed previously in our system. If we use the
<code>import</code> command to call for a library that does not exist in
our local system, the command will throw and error when executed. In
this case, you can use <code>pip</code> command in another termina
window to install the missing libraries. <a href="https://github.com/resbaz/Intro_Python_Nov2017/blob/master/Python_Installation.md" class="external-link">See
here for details</a> on how to do this.</p>
<p>Moreover, if we want to give the library a nickname to shorten the
command, we can add <code>as nickNameHere</code>. An example of
importing the pandas library using the common nickname <code>pd</code>
is:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre>
</div>
<p>Each time we call a function that’s in a library, we use the syntax
<code>LibraryName.FunctionName</code>. Adding the library name with a
<code>.</code> before the function name tells Python where to find the
function. In the example above, we have imported Pandas as
<code>pd</code>. This means we don’t have to type out
<code>pandas</code> each time we call a Pandas function.</p>
</div>
</section><section id="reading-csv-data-using-pandas"><h2 class="section-heading">Reading CSV Data Using Pandas<a class="anchor" aria-label="anchor" href="#reading-csv-data-using-pandas"></a>
</h2>
<hr class="half-width">
<p>We will begin by locating and reading our survey data which are in
CSV format. We can use Pandas’ <code>read_csv</code> function to pull
either a local (a file in our machine) or a remote (one that is
available for downloading from the web) file into a Pandas table or <a href="https://pandas.pydata.org/pandas-docs/stable/dsintro.html#dataframe" class="external-link">DataFrame</a>.</p>
<p>In order to read data in, we need to know where the data is stored on
your computer or its URL address if the file is available on the web. It
is recommended to place the data files in the same directory as the
Jupyter notebook if working with local files</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note that pd.read_csv is used because we imported pandas as pd</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># note that this assumes that the data file is in the same location</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># as the Jupyter notebook</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>pd.read_csv(<span class="st">"eebo.csv"</span>)</span></code></pre>
</div>
<div class="section level3">
<h3 id="so-whats-a-dataframe">So What’s a DataFrame?<a class="anchor" aria-label="anchor" href="#so-whats-a-dataframe"></a>
</h3>
<p>A DataFrame is a 2-dimensional data structure that can store data of
different types (including characters, integers, floating point values,
factors and more) in columns. It is similar to a spreadsheet or a
<code>data.frame</code> in R. A DataFrame always has an index (0-based).
An index refers to the position of an element in the data structure.</p>
<p>In a terminal window the above command yields the
<strong>output</strong> below. However, the output may differ slightly
if using Jupyter Notebooks:</p>
<pre><code>          TCP        EEBO     VID  \
0      A00002  99850634.0   15849   
1      A00005  99842408.0    7058   
2      A00007  99844302.0    9101   
3      A00008  99848896.0   14017   
4      A00011  99837000.0    1304
...
146  A00525  99856552        ...                854   Prentyd  London
147  A00527  99849909        ...                 72            London
148  A00535  99849912        ...                106        Saint-Omer 
[148 rows x 11 columns]</code></pre>
<p>We can see that there were 149 rows parsed. Each row has 11 columns.
The first column displayed is the <strong>index</strong> of the
DataFrame. The index is used to identify the position of the data, but
it is not an actual column of the DataFrame. It looks like the
<code>read_csv</code> function in Pandas read our file properly.
However, we haven’t saved any data to memory so we can not work with it
yet. We need to assign the DataFrame to a variable so we can call and
use the data. Remember that a variable is a name given to a value, such
as <code>x</code>, or <code>data</code>. We can create a new object with
a variable name by assigning a value to it using <code>=</code>.</p>
<p>Let’s call the imported survey data <code>eebo_df</code>:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>eebo_df <span class="op">=</span> pd.read_csv(<span class="st">"eebo.csv"</span>)</span></code></pre>
</div>
<p>Notice that when you assign the imported DataFrame to a variable,
Python does not produce any output on the screen. We can print the value
of the <code>eebo_df</code> object by typing its name into the Python
command prompt.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>eebo_df</span></code></pre>
</div>
<p>which prints contents like above</p>
</div>
<div class="section level3">
<h3 id="manipulating-our-index-data">Manipulating Our Index Data<a class="anchor" aria-label="anchor" href="#manipulating-our-index-data"></a>
</h3>
<p>Now we can start manipulating our data. First, let’s check the data
type of the data stored in <code>eebo_df</code> using the
<code>type</code> method. <strong>The <code>type</code> method and
<code>__class__</code> attribute</strong> tell us that
<code>eebo_df</code> is
<code>&lt;class 'pandas.core.frame.DataFrame'&gt;</code>.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(eebo_df)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this does the same thing as the above!</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>eebo_df.__class__</span></code></pre>
</div>
<p>We can also enter <code>eebo_df.dtypes</code> at our prompt to view
the data type for each column in our DataFrame. <code>int64</code>
represents numeric integer values - <code>int64</code> cells can not
store decimals. <code>object</code> represents strings (letters and
numbers). <code>float64</code> represents numbers with decimals.</p>
<pre><code><span><span class="va">eebo_df.dtypes</span></span></code></pre>
<p>which returns:</p>
<pre><code>TCP         object
EEBO        int64
VID         int64
STC         object
Status      object
Author      object
Date        int64
Title       object
Terms       object
Page Count  int64
Place       object
dtype: object</code></pre>
<p>We’ll talk a bit more about what the different formats mean in a
different lesson.</p>
<div class="section level4">
<h4 id="useful-ways-to-view-dataframe-objects-in-python">Useful Ways to View DataFrame objects in Python<a class="anchor" aria-label="anchor" href="#useful-ways-to-view-dataframe-objects-in-python"></a>
</h4>
<p>We can use attributes and methods provided by the DataFrame object to
summarize and access the data stored in it.</p>
<p>To access an attribute, use the DataFrame object name followed by the
attribute name <code>df_object.attribute</code>. For example, we can
access the <a href="https://pandas.pydata.org/docs/reference/indexing.html" class="external-link">Index
object</a> containing the column names of <code>eebo_df</code> by using
its <code>columns</code> attribute</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>eebo_df.columns</span></code></pre>
</div>
<p>As we will see later, we can use the contents of the Index object to
extract (slice) specific records from our DataFrame based on their
values.</p>
<p>Methods are called by using the syntax
<code>df_object.method()</code>. Note the inclusion of open brackets at
the end of the method. Python treats methods as
<strong>functions</strong> associated with a dataframe rather than just
a property of the object as with attributes. Similarly to functions,
methods can include optional parameters inside the brackets to change
their default behaviour.</p>
<p>As an example, <code>eebo_df.head()</code> gets the first few rows in
the DataFrame <code>eebo_df</code> using <strong>the <code>head()</code>
method</strong>. With a method, we can supply extra information within
the open brackets to control its behaviour.</p>
<p>Let’s look at the data using these.</p>
<div id="challenge---dataframes" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---dataframes" class="callout-inner">
<h3 class="callout-title">Challenge - DataFrames<a class="anchor" aria-label="anchor" href="#challenge---dataframes"></a>
</h3>
<div class="callout-content">
<p>Using our DataFrame <code>eebo_df</code>, try out the attributes
&amp; methods below to see what they return.</p>
<ol style="list-style-type: decimal">
<li><p><code>eebo_df.columns</code></p></li>
<li><p><code>eebo_df.shape</code> Take note of the output of
<code>shape</code> - what format does it return the shape of the
DataFrame in?</p></li>
</ol>
<p>HINT: <a href="https://docs.python.org/3/tutorial/datastructures.html#tuples-and-sequences" class="external-link">More
on tuples, here</a>.</p>
<ol start="3" style="list-style-type: decimal">
<li><p><code>eebo_df.head()</code> Also, what does
<code>eebo_df.head(15)</code> do?</p></li>
<li><p><code>eebo_df.tail()</code></p></li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="calculating-statistics-from-data-in-a-pandas-dataframe">Calculating Statistics From Data In A Pandas DataFrame<a class="anchor" aria-label="anchor" href="#calculating-statistics-from-data-in-a-pandas-dataframe"></a>
</h3>
<p>We’ve read our data into Python. Next, let’s perform some quick
summary statistics to learn more about the data that we’re working with.
We might want to know how many different authors are included in our
dataset, or how many works were published in a given year. We can
perform summary stats quickly using groups. But first we need to figure
out what we want to group by.</p>
<p>Let’s begin by exploring our data:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the column names</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>eebo_df.columns.values</span></code></pre>
</div>
<p>which <strong>returns</strong>:</p>
<pre><code>array(['TCP', 'EEBO', 'VID', 'STC', 'Status', 'Author', 'Date', 'Title',
       'Terms', 'Page Count', 'Place'], dtype=object)</code></pre>
<p>Let’s get a list of all the page counts. The <code>pd.unique</code>
function tells us all of the unique values in the <code>Pages</code>
column.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pd.unique(eebo_df[<span class="st">'Page Count'</span>])</span></code></pre>
</div>
<p>which <strong>returns</strong>:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>array([<span class="dv">134</span>, <span class="dv">302</span>, <span class="dv">386</span>,  <span class="dv">14</span>,  <span class="dv">54</span>,  <span class="dv">99</span>,   <span class="dv">1</span>,  <span class="dv">16</span>,  <span class="dv">26</span>,  <span class="dv">62</span>,  <span class="dv">50</span>,  <span class="dv">66</span>,  <span class="dv">30</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>         <span class="dv">6</span>,  <span class="dv">36</span>,   <span class="dv">8</span>,  <span class="dv">12</span>,  <span class="dv">24</span>,  <span class="dv">22</span>,   <span class="dv">7</span>,  <span class="dv">20</span>,  <span class="dv">40</span>,  <span class="dv">38</span>,  <span class="dv">13</span>,  <span class="dv">28</span>,  <span class="dv">10</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        <span class="dv">23</span>,   <span class="dv">2</span>, <span class="dv">112</span>,  <span class="dv">18</span>,   <span class="dv">4</span>,  <span class="dv">27</span>,  <span class="dv">42</span>,  <span class="dv">17</span>,  <span class="dv">46</span>,  <span class="dv">58</span>, <span class="dv">200</span>, <span class="dv">158</span>,  <span class="dv">65</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="dv">96</span>, <span class="dv">178</span>,  <span class="dv">52</span>, <span class="dv">774</span>,  <span class="dv">81</span>, <span class="dv">392</span>,  <span class="dv">74</span>, <span class="dv">162</span>,  <span class="dv">56</span>, <span class="dv">100</span>, <span class="dv">172</span>,  <span class="dv">94</span>,  <span class="dv">79</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>       <span class="dv">107</span>,  <span class="dv">48</span>, <span class="dv">102</span>, <span class="dv">343</span>, <span class="dv">136</span>,  <span class="dv">70</span>, <span class="dv">156</span>, <span class="dv">133</span>, <span class="dv">228</span>, <span class="dv">357</span>, <span class="dv">110</span>,  <span class="dv">72</span>,  <span class="dv">44</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        <span class="dv">43</span>,  <span class="dv">37</span>,  <span class="dv">98</span>, <span class="dv">566</span>, <span class="dv">500</span>, <span class="dv">746</span>, <span class="dv">884</span>, <span class="dv">254</span>, <span class="dv">618</span>, <span class="dv">274</span>, <span class="dv">188</span>, <span class="dv">374</span>,  <span class="dv">47</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="dv">34</span>, <span class="dv">177</span>,  <span class="dv">82</span>,  <span class="dv">78</span>,  <span class="dv">64</span>, <span class="dv">124</span>,  <span class="dv">80</span>, <span class="dv">108</span>, <span class="dv">182</span>, <span class="dv">120</span>,  <span class="dv">68</span>, <span class="dv">854</span>, <span class="dv">106</span>])</span></code></pre>
</div>
<div id="challenge---statistics" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---statistics" class="callout-inner">
<h3 class="callout-title">Challenge - Statistics<a class="anchor" aria-label="anchor" href="#challenge---statistics"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Create a list of unique locations found in the index data. Call
it <code>places</code>. How many unique location are there in the
data?</p></li>
<li><p>What is the difference between <code>len(places)</code> and
<code>eebo_df['Place'].nunique()</code>?</p></li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="groups-in-pandas"><h2 class="section-heading">Groups in Pandas<a class="anchor" aria-label="anchor" href="#groups-in-pandas"></a>
</h2>
<hr class="half-width">
<p>We often want to calculate summary statistics grouped by subsets or
attributes within fields of our data. For example, we might want to
calculate the average number of pages of the works in our DataFrame.</p>
<p>We can calculate basic statistics for all records in a single column
by using the syntax below:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>eebo_df[<span class="st">'Page Count'</span>].describe()</span></code></pre>
</div>
<p>gives <strong>output</strong></p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>count    <span class="fl">149.000000</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>mean     <span class="fl">104.382550</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>std      <span class="fl">160.125398</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="bu">min</span>        <span class="fl">1.000000</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="dv">25</span><span class="op">%</span>       <span class="fl">16.000000</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="dv">50</span><span class="op">%</span>       <span class="fl">52.000000</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="dv">75</span><span class="op">%</span>      <span class="fl">108.000000</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="bu">max</span>      <span class="fl">884.000000</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>Name: Page Count, dtype: float64</span></code></pre>
</div>
<p>We can also extract specific metrics for one or various columns if we
wish:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>eebo_df[<span class="st">'Page Count'</span>].<span class="bu">min</span>()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>eebo_df[<span class="st">'Page Count'</span>].<span class="bu">max</span>()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>eebo_df[<span class="st">'Page Count'</span>].mean()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>eebo_df[<span class="st">'Page Count'</span>].std()</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>eebo_df[<span class="st">'Page Count'</span>].count()</span></code></pre>
</div>
<p>But if we want to summarize by one or more variables, for example
author or publication date, we can use the <strong><code>.groupby</code>
method</strong>. When executed, this method creates a DataFrameGroupBy
object containing a subset of the original DataFrame. Once we’ve created
it, we can quickly calculate summary statistics by a group of our
choice. For example the following code will group our data by place of
publication.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group data by status</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="op">=</span> eebo_df.groupby(<span class="st">'Place'</span>)</span></code></pre>
</div>
<p>If we execute the <strong>pandas function
<code>describe</code></strong> on this new object we will obtain
descriptive stats for all the numerical columns in <code>eebo_df</code>
grouped by the different cities available in the <code>Place</code>
column of the DataFrame.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary statistics for all numeric columns by place</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>grouped_data.describe()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># provide the mean for each numeric column by place</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>grouped_data.mean()</span></code></pre>
</div>
<p><code>grouped_data.mean()</code> <strong>OUTPUT:</strong></p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>                                       EEBO     ...      Page Count</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>Place                                           ...                </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>Amsterdam                      <span class="fl">9.983700e+07</span>     ...       <span class="fl">54.000000</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>Antverpi                       <span class="fl">9.983759e+07</span>     ...       <span class="fl">34.000000</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>Antwerp                        <span class="fl">9.985185e+07</span>     ...       <span class="fl">40.000000</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>Cambridge                      <span class="fl">2.445926e+07</span>     ...        <span class="fl">1.000000</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>Emden                          <span class="fl">9.984713e+07</span>     ...       <span class="fl">58.000000</span></span></code></pre>
</div>
<p>The <code>groupby</code> command is powerful in that it allows us to
quickly generate summary stats.</p>
<div id="challenge---summary-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---summary-data" class="callout-inner">
<h3 class="callout-title">Challenge - Summary Data<a class="anchor" aria-label="anchor" href="#challenge---summary-data"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>What is the mean page length for books published in
<code>Amsterdam</code> and how many for <code>London</code>
</li>
<li>What happens when you group by two columns using the following
syntax and then grab mean values:</li>
</ol>
<ul>
<li><code>grouped_data2 = eebo_df.groupby(['EEBO','Page Count'])</code></li>
<li><code>grouped_data2.mean()</code></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Summarize the Date values in your data. HINT: you can use the
following syntax to only create summary statistics for one column in
your data <code>eebo_df['Page Count'].describe()</code>
</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Did you get #3 right?</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p><strong>A Snippet of the Output from challenge 3 looks
like:</strong></p>
<pre><code> 
       count    149.000000
       mean    1584.288591
       std       36.158864
       min     1515.000000
       25%     1552.000000
       50%     1583.000000
       75%     1618.000000
       max     1640.000000
         ...</code></pre>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="quickly-creating-summary-counts-in-pandas">Quickly Creating Summary Counts in Pandas<a class="anchor" aria-label="anchor" href="#quickly-creating-summary-counts-in-pandas"></a>
</h3>
<p>Let’s next count the number of samples for each author. We can do
this in a few ways, but we’ll use <code>groupby</code> combined with
<strong>a <code>count()</code> method</strong>.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count the number of texts by authors</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>author_counts <span class="op">=</span> eebo_df.groupby(<span class="st">'Author'</span>)[<span class="st">'EEBO'</span>].count()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(author_counts)</span></code></pre>
</div>
<p>Or, we can also count just the rows that have the author “A. B.”:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>eebo_df.groupby(<span class="st">'Author'</span>)[<span class="st">'EEBO'</span>].count()[<span class="st">'Aylett, Robert, 1583-1655?'</span>]</span></code></pre>
</div>
<div id="challenge---make-a-list" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---make-a-list" class="callout-inner">
<h3 class="callout-title">Challenge - Make a list<a class="anchor" aria-label="anchor" href="#challenge---make-a-list"></a>
</h3>
<div class="callout-content">
<p>What’s another way to create a list of authors and associated
<code>count</code> of the records in the data? Hint: you can perform
<code>count</code>, <code>min</code>, etc functions on groupby
DataFrames in the same way you can perform them on regular
DataFrames.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="basic-math-functions">Basic Math Functions<a class="anchor" aria-label="anchor" href="#basic-math-functions"></a>
</h3>
<p>If we wanted to, we could perform math on an entire numerical column
of our data. For example, we might normalize the page number of each
work in our data according to the mean of the entire DataFrame.</p>
<pre><code><span><span class="co"># multiply all page length values by 2</span></span>
<span><span class="va">eebo_df</span><span class="op">[</span><span class="st">'Page Count'</span><span class="op">]</span><span class="op">*</span><span class="fl">2</span></span></code></pre>
</div>
</section><section id="quick-easy-plotting-data-using-pandas"><h2 class="section-heading">Quick &amp; Easy Plotting Data Using Pandas<a class="anchor" aria-label="anchor" href="#quick-easy-plotting-data-using-pandas"></a>
</h2>
<hr class="half-width">
<p>We can plot our summary stats using Pandas, too.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># when using a Jupyter notebook, force graphs to appear in line</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect data together</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>date_count <span class="op">=</span> eebo_df.groupby(<span class="st">"Date"</span>)[<span class="st">"Status"</span>].count()</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>date_count.plot(kind<span class="op">=</span><span class="st">"bar"</span>)</span></code></pre>
</div>
<figure><img src="../fig/01_weight_by_date.png" alt="Weight by Species Plot" class="figure mx-auto d-block"></figure><p>What does this graph show? Let’s step through</p>
<ul>
<li>
<code>eebo_df.groupby("Date")</code> : This groups the texts by the
date in which they were published</li>
<li>
<code>eebo_df.groupby("Date")["Status"]</code> : This chooses a
single column to count, rather than counting all columns</li>
<li>
<code>eebo_df.groupby("Date")["Status"].count()</code> : this counts
the instances, i.e. how many texts in a given year have a status?</li>
<li>
<code>date_count.plot(kind="bar")</code> : this plots that data as a
bar chart</li>
</ul>
<pre><code>
&gt; ## Challenge - Plots
&gt;
&gt; 1. Create a plot of Authors across all Places per plot. Does it look how you
expect it to look?
{: .challenge}

&gt; ## Summary Plotting Challenge
&gt;
&gt; Create a stacked bar plot, showing the total pages published, per year, with
&gt; the different publishing locations stacked on top of each other. The Date
&gt; should go on the X axis, and the Page Count on the Y axis. Some tips are below
&gt; to help you solve this challenge:
&gt;
&gt; * [For more on Pandas plots, visit this link.](http://pandas.pydata.org/pandas-docs/stable/visualization.html#basic-plotting-plot)
&gt; * You can use the code that follows to create a stacked bar plot but the data to stack
&gt;  need to be in individual columns.  Here's a simple example with some data where
&gt;  'a', 'b', and 'c' are the groups, and 'one' and 'two' are the subgroups.
&gt;
&gt; ```
&gt; d = {'one' : pd.Series([1., 2., 3.], index=['a', 'b', 'c']),'two' : pd.Series([1., 2., 3., 4.], index=['a', 'b', 'c', 'd'])}
&gt; pd.DataFrame(d)
&gt; ```
&gt;
&gt; shows the following data
&gt;
&gt; ```
&gt;       one  two
&gt;   a    1    1
&gt;   b    2    2
&gt;   c    3    3
&gt;   d  NaN    4
&gt; ```
&gt;
&gt; We can plot the above with
&gt;
&gt; ```
&gt; # plot stacked data so columns 'one' and 'two' are stacked
&gt; my_df = pd.DataFrame(d)
&gt; my_df.plot(kind='bar', stacked=True, title="The title of my graph")
&gt; ```
&gt;
&gt; ![Stacked Bar Plot](../fig/stackedBar1.png)
&gt;
&gt; * You can use the `.unstack()` method to transform grouped data into columns
&gt; for each plotting.  Try running `.unstack()` on some DataFrames above and see
&gt; what it yields.
&gt;
&gt; Start by transforming the grouped data into an unstacked layout, then create
&gt; a stacked plot.
&gt;
&gt;
&gt;&gt; ## Solution to Summary Challenge
&gt;&gt;
&gt;&gt; First we group data by date and then by place. 
&gt;&gt;
&gt;&gt; ```python
&gt;&gt; date_place = eebo_df.groupby(['Date','Place'])
&gt;&gt; page_sum = date_place['Page Count'].sum()
&gt;&gt; ```
&gt;&gt;
&gt;&gt; This calculates the sums for each place, for each date, as a table
&gt;&gt;
&gt;&gt; ```
&gt;&gt; page_sum
&gt;&gt; Date    Place
&gt;&gt; 1515    London    302
&gt;&gt; 1519    Londini   74
&gt;&gt; 1526     London   150
&gt;&gt; 1528    London    386
&gt;&gt; &lt;other plots removed for brevity&gt;
&gt;&gt; ```
&gt;&gt; 
&gt;&gt; After that, we use the `.unstack()` function on our grouped data to figure
&gt;&gt; out the total contribution of each place, to each year, and then plot the
&gt;&gt; data
&gt;&gt; ```python
&gt;&gt; table = page_sum.unstack()
&gt;&gt; plot = table.plot(kind="bar", stacked=True, title="Pages published per year", figsize=(10,5))
&gt;&gt; plot.set_ylabel("Pages")
&gt;&gt; ```
&gt; {: .solution}
{: .challenge}</code></pre>
</section></section><section id="aio-02-index-slice-subset"><p>Content from <a href="02-index-slice-subset.html">Indexing, Slicing and Subsetting DataFrames in Python</a></p>
<hr>
<p>Last updated on 2024-02-13 |
        
        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/02-index-slice-subset.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I access specific data within my data set?</li>
<li>How can Python and Pandas help me to analyse my data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe what 0-based indexing is.</li>
<li>Manipulate and extract data using column headings and index
locations.</li>
<li>Employ slicing to select sets of data from a DataFrame.</li>
<li>Employ label and integer-based indexing to select ranges of data in
a dataframe.</li>
<li>Reassign values within subsets of a DataFrame.</li>
<li>Create a copy of a DataFrame.</li>
<li>Query /select a subset of data using a set of criteria using the
following operators: =, !=, &gt;, &lt;, &gt;=, &lt;=.</li>
<li>Locate subsets of data using masks.</li>
<li>Describe BOOLEAN objects in Python and manipulate data using
BOOLEANs.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In lesson 01, we read a CSV into a Python pandas DataFrame. We
learned:</p>
<ul>
<li>how to save the DataFrame to a named object,</li>
<li>how to perform basic math on the data,</li>
<li>how to calculate summary statistics, and</li>
<li>how to create plots of the data.</li>
</ul>
<p>In this lesson, we will explore <strong>ways to access different
parts of the data</strong> using:</p>
<ul>
<li>indexing,</li>
<li>slicing, and</li>
<li>subsetting.</li>
</ul>
<section id="loading-our-data"><h2 class="section-heading">Loading our data<a class="anchor" aria-label="anchor" href="#loading-our-data"></a>
</h2>
<hr class="half-width">
<p>We will continue to use the surveys dataset that we worked with in
the last lesson. Let’s reopen and read in the data again:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure pandas is loaded</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># read in the survey csv</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>eebo_df <span class="op">=</span> pd.read_csv(<span class="st">"eebo.csv"</span>)</span></code></pre>
</div>
</section><section id="indexing-and-slicing-in-python"><h2 class="section-heading">Indexing and Slicing in Python<a class="anchor" aria-label="anchor" href="#indexing-and-slicing-in-python"></a>
</h2>
<hr class="half-width">
<p>We often want to work with subsets of a <strong>DataFrame</strong>
object. There are different ways to accomplish this including: using
labels (column headings), numeric ranges, or specific x,y index
locations.</p>
</section><section id="selecting-data-using-labels-column-headings"><h2 class="section-heading">Selecting data using Labels (Column Headings)<a class="anchor" aria-label="anchor" href="#selecting-data-using-labels-column-headings"></a>
</h2>
<hr class="half-width">
<p>We use square brackets <code>[]</code> to select a subset of an
Python object. For example, we can select all data from a column named
<code>species_id</code> from the <code>surveys_df</code> DataFrame by
name. There are two ways to do this:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 1: select a 'subset' of the data using the column name</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>eebo_df[<span class="st">'Place'</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 2: use the column name as an 'attribute'; gives the same output</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>eebo_df.Place</span></code></pre>
</div>
<p>We can also create a new object that contains only the data within
the <code>Status</code> column as follows:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creates an object, texts_species, that only contains the `status_id` column</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>texts_status <span class="op">=</span> eebo_df[<span class="st">'Status'</span>]</span></code></pre>
</div>
<p>We can pass a list of column names too, as an index to select columns
in that order. This is useful when we need to reorganize our data.</p>
<p><strong>NOTE:</strong> If a column name is not contained in the
DataFrame, an exception (error) will be raised.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select the author and EEBO columns from the DataFrame</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>eebo_df[[<span class="st">'Author'</span>, <span class="st">'EEBO'</span>]]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># what happens when you flip the order?</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>eebo_df[[<span class="st">'EEBO'</span>, <span class="st">'Author'</span>]]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#what happens if you ask for a column that doesn't exist?</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>eebo_df[<span class="st">'Texts'</span>]</span></code></pre>
</div>
</section><section id="extracting-range-based-subsets-slicing"><h2 class="section-heading">Extracting Range based Subsets: Slicing<a class="anchor" aria-label="anchor" href="#extracting-range-based-subsets-slicing"></a>
</h2>
<hr class="half-width">
<p><strong>REMINDER</strong>: Python Uses 0-based Indexing</p>
<p>Let’s remind ourselves that Python uses 0-based indexing. This means
that the first element in an object is located at position 0. This is
different from other tools like R and Matlab that index elements within
objects starting at 1.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of numbers:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span></code></pre>
</div>
<p><img src="../fig/slicing-indexing.svg" alt="indexing diagram" class="figure"><img src="../fig/slicing-slicing.svg" alt="slicing diagram" class="figure"></p>
<div id="challenge---extracting-data" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---extracting-data" class="callout-inner">
<h3 class="callout-title">Challenge - Extracting data<a class="anchor" aria-label="anchor" href="#challenge---extracting-data"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>What value does the code below return?</li>
</ol>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">0</span>]</span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>How about this:</li>
</ol>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">5</span>]</span></code></pre>
</div>
<ol start="3" style="list-style-type: decimal">
<li><p>In the example above, calling <code>a[5]</code> returns an error.
Why is that?</p></li>
<li><p>What about?</p></li>
</ol>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>a[<span class="bu">len</span>(a)]</span></code></pre>
</div>
</div>
</div>
</div>
</section><section id="slicing-subsets-of-rows-in-python"><h2 class="section-heading">Slicing Subsets of Rows in Python<a class="anchor" aria-label="anchor" href="#slicing-subsets-of-rows-in-python"></a>
</h2>
<hr class="half-width">
<p>Slicing using the <code>[]</code> operator selects a set of rows
and/or columns from a DataFrame. To slice out a set of rows, you use the
following syntax: <code>data[start:stop]</code>. When slicing in pandas
the start bound is included in the output. The stop bound is one step
BEYOND the row you want to select. So if you want to select rows 0, 1
and 2 your code would look like this:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select rows 0, 1, 2 (row 3 is not selected)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>eebo_df[<span class="dv">0</span>:<span class="dv">3</span>]</span></code></pre>
</div>
<p>The stop bound in Python is different from what you might be used to
in languages like Matlab and R.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select the first 5 rows (rows 0, 1, 2, 3, 4)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>eebo_df[:<span class="dv">5</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># select the last element in the list</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># (the slice starts at the last element,</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># and ends at the end of the list)</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>eebo_df[<span class="op">-</span><span class="dv">1</span>:]</span></code></pre>
</div>
<p>We can also reassign values within subsets of our DataFrame.</p>
<p>But before we do that, let’s look at the difference between the
concept of copying objects and the concept of referencing objects in
Python.</p>
</section><section id="copying-objects-vs-referencing-objects-in-python"><h2 class="section-heading">Copying Objects vs Referencing Objects in Python<a class="anchor" aria-label="anchor" href="#copying-objects-vs-referencing-objects-in-python"></a>
</h2>
<hr class="half-width">
<p>Let’s start with an example:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using the 'copy() method'</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>true_copy_eebo_df <span class="op">=</span> eebo_df.copy()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># using '=' operator</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>ref_eebo_df <span class="op">=</span> eebo_df</span></code></pre>
</div>
<p>You might think that the code <code>ref_eebo_df = eebo_df</code>
creates a fresh distinct copy of the <code>surveys_df</code> DataFrame
object. However, using the <code>=</code> operator in the simple
statement <code>y = x</code> does <strong>not</strong> create a copy of
our DataFrame. Instead, <code>y = x</code> creates a new variable
<code>y</code> that references the <strong>same</strong> object that
<code>x</code> refers to. To state this another way, there is only
<strong>one</strong> object (the DataFrame), and both <code>x</code> and
<code>y</code> refer to it.</p>
<p>In contrast, the <code>copy()</code> method for a DataFrame creates a
true copy of the DataFrame.</p>
<p>Let’s look at what happens when we reassign the values within a
subset of the DataFrame that references another DataFrame object:</p>
<pre><code> # Assign the value `0` to the first three rows of data in the DataFrame
 ref_eebo_df[0:3] = 0
 ```

Let's try the following code:

 ```
# ref_eebo_df was created using the '=' operator
 ref_eebo_df.head()

 # surveys_df is the original dataframe
 eebo_df.head()</code></pre>
<p>What is the difference between these two dataframes?</p>
<p>When we assigned the first 3 columns the value of <code>0</code>
using the <code>ref_surveys_df</code> DataFrame, the
<code>surveys_df</code> DataFrame is modified too. Remember we created
the reference <code>ref_survey_df</code> object above when we did
<code>ref_survey_df = surveys_df</code>. Remember
<code>surveys_df</code> and <code>ref_surveys_df</code> refer to the
same exact DataFrame object. If either one changes the object, the other
will see the same changes to the reference object.</p>
<p><strong>To review and recap</strong>:</p>
<ul>
<li>
<p><strong>Copy</strong> uses the dataframe’s <code>copy()</code>
method</p>
<pre><code><span><span class="va">true_copy_eebo_df</span> <span class="op">=</span> <span class="fu">eebo_df.copy</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</li>
<li>
<p>A <strong>Reference</strong> is created using the <code>=</code>
operator</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ref_eebo_df <span class="op">=</span> eebo_df</span></code></pre>
</div>
</li>
</ul>
<p>Okay, that’s enough of that. Let’s create a brand new clean dataframe
from the original data CSV file.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>eebo_df <span class="op">=</span> pd.read_csv(<span class="st">"eebo.csv"</span>)</span></code></pre>
</div>
</section><section id="slicing-subsets-of-rows-and-columns-in-python"><h2 class="section-heading">Slicing Subsets of Rows and Columns in Python<a class="anchor" aria-label="anchor" href="#slicing-subsets-of-rows-and-columns-in-python"></a>
</h2>
<hr class="half-width">
<p>We can select specific ranges of our data in both the row and column
directions using either label or integer-based indexing. Columns can be
selected either by their name, or by the index of their location in the
dataframe. Rows can only be selected by their index.</p>
<ul>
<li>
<code>loc</code> is primarily <em>label</em> based indexing.
<em>Integers</em> may be used but they are interpreted as a
<em>label</em>.</li>
<li>
<code>iloc</code> is primarily <em>integer</em> based indexing</li>
</ul>
<p>To select a subset of rows <strong>and</strong> columns from our
DataFrame, we can use the <code>iloc</code> method. For example, we can
select month, day and year (columns 2, 3 and 4 if we start counting at
1), like this:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># iloc[row slicing, column slicing]</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>eebo_df.iloc[<span class="dv">0</span>:<span class="dv">3</span>, <span class="dv">1</span>:<span class="dv">4</span>]</span></code></pre>
</div>
<p>which gives the <strong>output</strong></p>
<pre><code>         EEBO    VID                       STC
0  99850634.0  15849  STC 1000.5; ESTC S115415
1  99842408.0   7058   STC 10000; ESTC S106695
2  99844302.0   9101   STC 10002; ESTC S108645</code></pre>
<p>Notice that we asked for a slice from 0:3. This yielded 3 rows of
data. When you ask for 0:3, you are actually telling Python to start at
index 0 and select rows 0, 1, 2 <strong>up to but not including
3</strong>.</p>
<p>Let’s explore some other ways to index and select subsets of
data:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select all columns for rows of index values 0 and 10</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>eebo_df.loc[[<span class="dv">0</span>, <span class="dv">10</span>], :]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># what does this do?</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>eebo_df.loc[<span class="dv">0</span>, [<span class="st">'Author'</span>, <span class="st">'Title'</span>, <span class="st">'Status'</span>]]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># What happens when you type the code below?</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>eebo_df.loc[[<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">149</span>], :]</span></code></pre>
</div>
<p><strong>NOTE</strong>: Labels must be found in the DataFrame or you
will get a <code>KeyError</code>.</p>
<p>Indexing by labels <code>loc</code> differs from indexing by integers
<code>iloc</code>. With <code>iloc</code>, the start bound and the stop
bound are <strong>inclusive</strong>. When using <code>loc</code>
instead, integers <em>can</em> also be used, but the integers refer to
the index label and not the position. For example, using
<code>loc</code> and select 1:4 will get a different result than using
<code>iloc</code> to select rows 1:4.</p>
<p>We can also select a specific data value using a row and column
location within the DataFrame and <code>iloc</code> indexing:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax for iloc indexing to finding a specific data element</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>dat.iloc[row, column]</span></code></pre>
</div>
<p>In this <code>iloc</code> example,</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>eebo_df.iloc[<span class="dv">2</span>, <span class="dv">6</span>]</span></code></pre>
</div>
<p>gives the <strong>output</strong></p>
<pre><code><span><span class="st">'1528'</span></span></code></pre>
<p>Remember that Python indexing begins at 0. So, the index location [2,
6] selects the element that is 3 rows down and 7 columns over in the
DataFrame.</p>
<div id="challenge---range" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---range" class="callout-inner">
<h3 class="callout-title">Challenge - Range<a class="anchor" aria-label="anchor" href="#challenge---range"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Given the three range indicies below, what do you expect to get
back? Does it match what you actually get back?</li>
</ol>
<ul>
<li><code>eebo_df[0:1]</code></li>
<li><code>eebo_df[:4]</code></li>
<li><code>eebo_df[:-1]</code></li>
</ul>
</div>
</div>
</div>
</section><section id="subsetting-data-using-criteria"><h2 class="section-heading">Subsetting Data using Criteria<a class="anchor" aria-label="anchor" href="#subsetting-data-using-criteria"></a>
</h2>
<hr class="half-width">
<p>We can also select a subset of our data using criteria. For example,
we can select all rows that have a status value of Free:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>eebo_df.loc[eebo_df[<span class="st">"Terms"</span>].<span class="bu">str</span>.contains(<span class="st">"sermon"</span>, na<span class="op">=</span><span class="va">False</span>)]</span></code></pre>
</div>
<p>Which produces the following output:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>        TCP      EEBO  ...  Page Count   Place</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="dv">23</span>   A00156  <span class="dv">99851064</span>  ...           <span class="dv">8</span>  London</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="dv">27</span>   A00164  <span class="dv">99851065</span>  ...           <span class="dv">7</span>  London</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="dv">113</span>  A00426  <span class="dv">99857357</span>  ...          <span class="dv">72</span>  London</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="dv">141</span>  A00510  <span class="dv">99852090</span>  ...          <span class="dv">48</span>  London</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span> rows x <span class="dv">11</span> columns]</span></code></pre>
</div>
<p>Or we can select all rows with a page length greater than 100:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>eebo_df[eebo_df[<span class="st">"Page Count"</span>] <span class="op">&gt;</span> <span class="dv">100</span>]</span></code></pre>
</div>
<p>We can define sets of criteria too:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>eebo_df[(eebo_df.Date <span class="op">&gt;=</span> <span class="dv">1500</span>) <span class="op">&amp;</span> (eebo_df.Date <span class="op">&lt;=</span> <span class="dv">1550</span>)]</span></code></pre>
</div>
<div class="section level3">
<h3 id="python-syntax-cheat-sheet">Python Syntax Cheat Sheet<a class="anchor" aria-label="anchor" href="#python-syntax-cheat-sheet"></a>
</h3>
<p>Use can use the syntax below when querying data by criteria from a
DataFrame. Experiment with selecting various subsets of the “surveys”
data.</p>
<ul>
<li>Equals: <code>==</code>
</li>
<li>Not equals: <code>!=</code>
</li>
<li>Greater than, less than: <code>&gt;</code> or <code>&lt;</code>
</li>
<li>Greater than or equal to <code>&gt;=</code>
</li>
<li>Less than or equal to <code>&lt;=</code>
</li>
</ul>
<div id="challenge---advanced-queries" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---advanced-queries" class="callout-inner">
<h3 class="callout-title">Challenge - Advanced Queries<a class="anchor" aria-label="anchor" href="#challenge---advanced-queries"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Select a subset of rows in the <code>eebo_df</code> DataFrame
that contain data from the year 1540 and that contain page count values
less than or equal to 8. How many rows did you end up with? What did
your neighbor get?</p></li>
<li><p>You can use the <code>isin</code> command in Python to query a
DataFrame based upon a list of values as follows. Notice how the
indexing relies on a reference to the dataframe <em>being indexed</em>.
Think about the <em>order</em> in which the computer must evaluate these
statements.</p></li>
</ol>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>eebo_df[</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>        eebo_df[<span class="st">'Date'</span>].isin([listGoesHere])</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>        ]</span></code></pre>
</div>
<p>Use the <code>isin</code> function to find all books written by
Robert Aylett and Robert Aytoun. How many are there?</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Experiment with other queries. Create a query that finds all rows
with a Page Count value &gt; or equal to 1.</p></li>
<li><p>The <code>~</code> symbol in Python can be used to return the
OPPOSITE of the selection that you specify in Python. It is equivalent
to <strong>is not in</strong>. Write a query that selects all rows with
Date NOT equal to 1500 or 1600 in the eebo data.</p></li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="using-masks-to-identify-a-specific-condition"><h2 class="section-heading">Using masks to identify a specific condition<a class="anchor" aria-label="anchor" href="#using-masks-to-identify-a-specific-condition"></a>
</h2>
<hr class="half-width">
<p>A <strong>mask</strong> can be useful to locate where a particular
subset of values exist or don’t exist - for example, NaN, or “Not a
Number” values. To understand masks, we also need to understand
<code>BOOLEAN</code> objects in Python.</p>
<p>Boolean values include <code>True</code> or <code>False</code>. For
example,</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set x to 5</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># what does the code below return?</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">&gt;</span> <span class="dv">5</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># how about this?</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">==</span> <span class="dv">5</span></span></code></pre>
</div>
<p>When we ask Python what the value of <code>x &gt; 5</code> is, we get
<code>False</code>. This is because the condition,<code>x</code> is not
greater than 5, is not met since <code>x</code> is equal to 5.</p>
<p>To create a boolean mask:</p>
<ul>
<li>Set the True / False criteria
(e.g. <code>values &gt; 5 = True</code>)</li>
<li>Python will then assess each value in the object to determine
whether the value meets the criteria (True) or not (False).</li>
<li>Python creates an output object that is the same shape as the
original object, but with a <code>True</code> or <code>False</code>
value for each index location.</li>
</ul>
<p>Let’s try this out. Let’s identify all locations in the survey data
that have null (missing or NaN) data values. We can use the
<code>isnull</code> method to do this. The <code>isnull</code> method
will compare each cell with a null value. If an element has a null
value, it will be assigned a value of <code>True</code> in the output
object.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pd.isnull(eebo_df)</span></code></pre>
</div>
<p>A snippet of the output is below:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>         TCP   EEBO    VID    STC  Status  Author   Date  Title  Terms  Pages</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>      <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>   <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">True</span>  <span class="va">False</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>   <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>   <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>   <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">149</span> rows x <span class="dv">11</span> columns]</span></code></pre>
</div>
<p>To select the rows where there are null values, we can use the mask
as an index to subset our data as follows:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To select just the rows with NaN values, we can use the 'any()' method</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>eebo_df[</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>        pd.isnull(eebo_df).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>        ]</span></code></pre>
</div>
<p>Note that the <code>weight</code> column of our DataFrame contains
many <code>null</code> or <code>NaN</code> values. We will explore ways
of dealing with this in Lesson 03.</p>
<p>We can run <code>isnull</code> on a particular column too. What does
the code below do?</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># what does this do?</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>empty_authors <span class="op">=</span> eebo_df[</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                        pd.isnull(eebo_df[<span class="st">'Author'</span>])</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                        ][<span class="st">'Author'</span>]</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(empty_authors)</span></code></pre>
</div>
<p>Let’s take a minute to look at the statement above. We are using the
Boolean object <code>pd.isnull(eebo_df['Author'])</code> as an index to
<code>eebo_df</code>. We are asking Python to select rows that have a
<code>NaN</code> value of author.</p>
<div id="challenge---putting-it-all-together" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---putting-it-all-together" class="callout-inner">
<h3 class="callout-title">Challenge - Putting it all together<a class="anchor" aria-label="anchor" href="#challenge---putting-it-all-together"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Create a new DataFrame that only contains titles with status
values that are <strong>not</strong> from London. Assign each status
value in the new DataFrame to a new value of ‘x’. Determine the number
of null values in the subset.</p></li>
<li><p>Create a new DataFrame that contains only observations that are
of status free and where page count values are greater than
100.</p></li>
</ol>
</div>
</div>
</div>
</section></section><section id="aio-03-data-types-and-format"><p>Content from <a href="03-data-types-and-format.html">Data Types and Formats</a></p>
<hr>
<p>Last updated on 2024-02-13 |
        
        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/03-data-types-and-format.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What types of data can be contained in a DataFrame?</li>
<li>Why is the data type important?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe how information is stored in a Python DataFrame.</li>
<li>Define the two main types of data in Python: text and numerics.</li>
<li>Examine the structure of a DataFrame.</li>
<li>Modify the format of values in a DataFrame.</li>
<li>Describe how data types impact operations.</li>
<li>Define, manipulate, and interconvert integers and floats in
Python.</li>
<li>Analyze datasets having missing/null values (NaN values).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>The format of individual columns and rows will impact analysis
performed on a dataset read into python. For example, you can’t perform
mathematical calculations on a string (text formatted data). This might
seem obvious, however sometimes numeric values are read into python as
strings. In this situation, when you then try to perform calculations on
the string-formatted numeric data, you get an error.</p>
<p>In this lesson we will review ways to explore and better understand
the structure and format of our data.</p>
<section id="types-of-data"><h2 class="section-heading">Types of Data<a class="anchor" aria-label="anchor" href="#types-of-data"></a>
</h2>
<hr class="half-width">
<p>How information is stored in a DataFrame or a python object affects
what we can do with it and the outputs of calculations as well. There
are two main types of data that we’re explore in this lesson: numeric
and text data types.</p>
<div class="section level3">
<h3 id="numeric-data-types">Numeric Data Types<a class="anchor" aria-label="anchor" href="#numeric-data-types"></a>
</h3>
<p>Numeric data types include integers and floats. A <strong>floating
point</strong> (known as a float) number has decimal points even if that
decimal point value is 0. For example: 1.13, 2.0 1234.345. If we have a
column that contains both integers and floating point numbers, Pandas
will assign the entire column to the float data type so the decimal
points are not lost.</p>
<p>An <strong>integer</strong> will never have a decimal point. Thus if
we wanted to store 1.13 as an integer it would be stored as 1.
Similarly, 1234.345 would be stored as 1234. You will often see the data
type <code>Int64</code> in python which stands for 64 bit integer. The
64 simply refers to the memory allocated to store data in each cell
which effectively relates to how many digits it can store in each
“cell”. Allocating space ahead of time allows computers to optimize
storage and processing efficiency.</p>
</div>
<div class="section level3">
<h3 id="text-data-type">Text Data Type<a class="anchor" aria-label="anchor" href="#text-data-type"></a>
</h3>
<p>Text data type is known as Strings in Python, or Objects in Pandas.
Strings can contain numbers and / or characters. For example, a string
might be a word, a sentence, or several sentences. A Pandas object might
also be a plot name like ‘plot1’. A string can also contain or consist
of numbers. For instance, ‘1234’ could be stored as a string. As could
‘10.23’. However <strong>strings that contain numbers can not be used
for mathematical operations</strong>!</p>
<p>Pandas and base Python use slightly different names for data types.
More on this is in the table below:</p>
<table class="table">
<colgroup>
<col width="9%">
<col width="17%">
<col width="73%">
</colgroup>
<thead><tr class="header">
<th>Pandas Type</th>
<th>Native Python Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>object</td>
<td>string</td>
<td>The most general dtype. Will be assigned to your column if column
has mixed types (numbers and strings).</td>
</tr>
<tr class="even">
<td>int64</td>
<td>int</td>
<td>Numeric characters. 64 refers to the memory allocated to hold this
character.</td>
</tr>
<tr class="odd">
<td>float64</td>
<td>float</td>
<td>Numeric characters with decimals. If a column contains numbers and
NaNs(see below), pandas will default to float64, in case your missing
value has a decimal.</td>
</tr>
<tr class="even">
<td>datetime64, timedelta[ns]</td>
<td>N/A (but see the <a href="https://doc.python.org/2/library/datetime.html" class="external-link">datetime</a>
module in Python’s standard library)</td>
<td>Values meant to hold time data. Look into these for time series
experiments.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="checking-the-format-of-our-data">Checking the format of our data<a class="anchor" aria-label="anchor" href="#checking-the-format-of-our-data"></a>
</h3>
<p>Now that we’re armed with a basic understanding of numeric and text
data types, let’s explore the format of our survey data. We’ll be
working with the same <code>surveys.csv</code> dataset that we’ve used
in previous lessons.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note that pd.read_csv is used because we imported pandas as pd</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>eebo_df <span class="op">=</span> pd.read_csv(<span class="st">"eebo.csv"</span>)</span></code></pre>
</div>
<p>Remember that we can check the type of an object like this:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(eebo_df)</span></code></pre>
</div>
<p><strong>OUTPUT:</strong> <code>pandas.core.frame.DataFrame</code></p>
<p>Next, let’s look at the structure of our surveys data. In pandas, we
can check the type of one column in a DataFrame using the syntax
<code>dataFrameName[column_name].dtype</code>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>eebo_df[<span class="st">'TCP'</span>].dtype</span></code></pre>
</div>
<p><strong>OUTPUT:</strong> <code>dtype('O')</code></p>
<p>A type ‘O’ just stands for “object” which in Pandas’ world is a
string (text).</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>eebo_df[<span class="st">'EEBO'</span>].dtype</span></code></pre>
</div>
<p><strong>OUTPUT:</strong> <code>dtype('int64')</code></p>
<p>The type <code>int64</code> tells us that python is storing each
value within this column as a 64 bit integer. We can use the
<code>dat.dtypes</code> command to view the data type for each column in
a DataFrame (all at once).</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>eebo_df.dtypes</span></code></pre>
</div>
<p>which <strong>returns</strong>:</p>
<pre><code>TCP        object
EEBO       int64
VID        object
STC        object
Status     object
Author     object
Date       object
Title      object
Terms      object
Page Count int64
Place      object
dtype: object</code></pre>
<p>Note that most of the columns in our Survey data are of type
<code>object</code>. This means that they are strings. But the EEBO
column is a integer value which means it contains whole numbers.</p>
</div>
<div class="section level3">
<h3 id="working-with-integers-and-floats">Working With Integers and Floats<a class="anchor" aria-label="anchor" href="#working-with-integers-and-floats"></a>
</h3>
<p>So we’ve learned that computers store numbers in one of two ways: as
integers or as floating-point numbers (or floats). Integers are the
numbers we usually count with. Floats have fractional parts (decimal
places). Let’s next consider how the data type can impact mathematical
operations on our data. Addition, subtraction, division and
multiplication work on floats and integers as we’d expect.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">5</span><span class="op">+</span><span class="dv">5</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">24</span><span class="op">-</span><span class="dv">4</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span></span></code></pre>
</div>
<p>If we divide one integer by another, we get a float. The result on
python 3 is different than in python 2, where the result is an integer
(integer division).</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">5</span><span class="op">/</span><span class="dv">9</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5555555555555556</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">10</span><span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fl">3.3333333333333335</span></span></code></pre>
</div>
<p>We can also convert a floating point number to an integer or an
integer to floating point number. Notice that Python by default rounds
down when it converts from floating point to integer.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert a to integer</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">7.83</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">int</span>(a)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to float</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="bu">float</span>(b)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fl">7.0</span></span></code></pre>
</div>
</div>
</section><section id="working-with-our-index-data"><h2 class="section-heading">Working With Our Index Data<a class="anchor" aria-label="anchor" href="#working-with-our-index-data"></a>
</h2>
<hr class="half-width">
<p>Getting back to our data, we can modify the format of values within
our data, if we want. For instance, we could convert the
<code>EEBO</code> field to integer values.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the record_id field from an integer to a float</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>eebo_df[<span class="st">'Page Count'</span>] <span class="op">=</span> eebo_df[<span class="st">'Page Count'</span>].astype(<span class="st">'float64'</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>eebo_df[<span class="st">'Page Count'</span>].dtype</span></code></pre>
</div>
<p><strong>OUTPUT:</strong> <code>dtype('float64')</code></p>
<div class="section level3">
<h3 id="missing-data-values---nan">Missing Data Values - NaN<a class="anchor" aria-label="anchor" href="#missing-data-values---nan"></a>
</h3>
<p>What happened in the last challenge activity? Notice that this throws
a value error: <code>ValueError: Cannot convert NA to integer</code>. If
we look at the <code>weight</code> column in the surveys data we notice
that there are NaN (<strong>N</strong>ot <strong>a</strong>
<strong>N</strong>umber) values. <em>NaN</em> values are undefined
values that cannot be represented mathematically. Pandas, for example,
will read an empty cell in a CSV or Excel sheet as a NaN. NaNs have some
desirable properties: if we were to average the <code>weight</code>
column without replacing our NaNs, Python would know to skip over those
cells.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>eebo_df[<span class="st">'EEBO'</span>].mean()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fl">84280511.94630873</span></span></code></pre>
</div>
<p>Dealing with missing data values is always a challenge. It’s
sometimes hard to know why values are missing - was it because of a data
entry error? Or data that someone was unable to collect? Should the
value be 0? We need to know how missing values are represented in the
dataset in order to make good decisions. If we’re lucky, we have some
metadata that will tell us more about how null values were handled.</p>
<p>For instance, in some disciplines, like Remote Sensing, missing data
values are often defined as -9999. Having a bunch of -9999 values in
your data could really alter numeric calculations. Often in
spreadsheets, cells are left empty where no data are available. Pandas
will, by default, replace those missing values with NaN. However it is
good practice to get in the habit of intentionally marking cells that
have no data, with a no data value! That way there are no questions in
the future when you (or someone else) explores your data.</p>
<div class="section level4">
<h4 id="where-are-the-nans">Where Are the NaN’s?<a class="anchor" aria-label="anchor" href="#where-are-the-nans"></a>
</h4>
<p>Let’s explore the NaN values in our data a bit further. Using the
tools we learned in lesson 02, we can figure out how many rows contain
NaN values for weight. We can also create a new subset from our data
that only contains rows with weight values &gt; 0 (ie select meaningful
weight values):</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(eebo_df[pd.isnull(eebo_df.EEBO)])</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># how many rows have weight values?</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(eebo_df[eebo_df.EEBO <span class="op">&gt;</span> <span class="dv">0</span>])</span></code></pre>
</div>
<p>We can replace all NaN values with zeroes using the
<code>.fillna()</code> method (after making a copy of the data so we
don’t lose our work):</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> eebo_df.copy()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fill all NaN values with 0</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'EEBO'</span>] <span class="op">=</span> df1[<span class="st">'EEBO'</span>].fillna(<span class="dv">0</span>)</span></code></pre>
</div>
<p>However NaN and 0 yield different analysis results. The mean value
when NaN values are replaced with 0 is different from when NaN values
are simply thrown out or ignored.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'EEBO'</span>].mean()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fl">52170900.611285985</span></span></code></pre>
</div>
<p>We can fill NaN values with any value that we chose. The code below
fills all NaN values with a mean for all weight values.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a> df1[<span class="st">'EEBO'</span>] <span class="op">=</span> eebo_df[<span class="st">'EEBO'</span>].fillna(eebo_df[<span class="st">'EEBO'</span>].mean())</span></code></pre>
</div>
<p>We could also chose to create a subset of our data, only keeping rows
that do not contain NaN values.</p>
<p>The point is to make conscious decisions about how to manage missing
data. This is where we think about how our data will be used and how
these values will impact the scientific conclusions made from the
data.</p>
<p>Python gives us all of the tools that we need to account for these
issues. We just need to be cautious about how the decisions that we make
impact scientific results.</p>
<div id="challenge---counting" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---counting" class="callout-inner">
<h3 class="callout-title">Challenge - Counting<a class="anchor" aria-label="anchor" href="#challenge---counting"></a>
</h3>
<div class="callout-content">
<p>Count the number of missing values per column. Hint: The method
.count() gives you the number of non-NA observations per column. Try
looking to the .isnull() method.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="recap">Recap<a class="anchor" aria-label="anchor" href="#recap"></a>
</h3>
<p>What we’ve learned:</p>
<ul>
<li>How to explore the data types of columns within a DataFrame</li>
<li>How to change the data type</li>
<li>What NaN values are, how they might be represented, and what this
means for your work</li>
<li>How to replace NaN values, if desired</li>
</ul>
</div>
</section></section><section id="aio-04-merging-data"><p>Content from <a href="04-merging-data.html">Combining DataFrames with pandas</a></p>
<hr>
<p>Last updated on 2024-02-13 |
        
        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/04-merging-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Can I work with data from multiple sources?</li>
<li>How can I combine data from different data sets?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Combine data from multiple files into a single DataFrame using merge
and concat.</li>
<li>Combine two DataFrames using a unique ID found in both
DataFrames.</li>
<li>Employ <code>to_csv</code> to export a DataFrame in CSV format.</li>
<li>Join DataFrames using common fields (join keys).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In many “real world” situations, the data that we want to use come in
multiple files. We often need to combine these files into a single
DataFrame to analyze the data. The pandas package provides <a href="https://pandas.pydata.org/pandas-docs/stable/merging.html" class="external-link">various
methods for combining DataFrames</a> including <code>merge</code> and
<code>concat</code>.</p>
<p>To work through the examples below, we first need to load the species
and surveys files into pandas DataFrames. The authors.csv and places.csv
data can be found in the data folder.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>authors_df <span class="op">=</span> pd.read_csv(<span class="st">"authors.csv"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                         keep_default_na<span class="op">=</span><span class="va">False</span>, na_values<span class="op">=</span>[<span class="st">""</span>])</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>authors_df</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        TCP                                             Author</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>    A00002                         Aylett, Robert, <span class="dv">1583</span><span class="op">-</span><span class="dv">1655</span>?</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    A00005  Higden, Ranulf, d. <span class="fl">1364.</span> Polycronicon. English...</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>    A00007             Higden, Ranulf, d. <span class="fl">1364.</span> Polycronicon.</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>    A00008          Wood, William, fl. <span class="dv">1623</span>, attributed name.</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>    A00011</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>places_df <span class="op">=</span> pd.read_csv(<span class="st">"places.csv"</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                         keep_default_na<span class="op">=</span><span class="va">False</span>, na_values<span class="op">=</span>[<span class="st">""</span>])</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>places_df</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    A00002                         London</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>   A00005                         London</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   A00007                         London</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   A00008               The Netherlands?</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   A00011                      Amsterdam</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   A00012                         London</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>   A00014                         London</span></code></pre>
</div>
<p>Take note that the <code>read_csv</code> method we used can take some
additional options which we didn’t use previously. Many functions in
python have a set of options that can be set by the user if needed. In
this case, we have told Pandas to assign empty values in our CSV to NaN
<code>keep_default_na=False, na_values=[""]</code>. <a href="https://pandas.pydata.org/pandas-docs/dev/generated/pandas.io.parsers.read_csv.html" class="external-link">More
about all of the read_csv options here.</a></p>
<section id="concatenating-dataframes"><h2 class="section-heading">Concatenating DataFrames<a class="anchor" aria-label="anchor" href="#concatenating-dataframes"></a>
</h2>
<hr class="half-width">
<p>We can use the <code>concat</code> function in Pandas to append
either columns or rows from one DataFrame to another. Let’s grab two
subsets of our data to see how this works.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in first 10 lines of the places table</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>place_sub <span class="op">=</span> places_df.head(<span class="dv">10</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># grab the last 20 rows </span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>place_sub_last10 <span class="op">=</span> places_df.tail(<span class="dv">20</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#reset the index values to the second dataframe appends properly</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>place_sub_last10 <span class="op">=</span> place_sub_last10.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># drop=True option avoids adding new index column with old index values</span></span></code></pre>
</div>
<p>When we concatenate DataFrames, we need to specify the axis.
<code>axis=0</code> tells Pandas to stack the second DataFrame under the
first one. It will automatically detect whether the column names are the
same and will stack accordingly. <code>axis=1</code> will stack the
columns in the second DataFrame to the RIGHT of the first DataFrame. To
stack the data vertically, we need to make sure we have the same columns
and associated column format in both datasets. When we stack
horizonally, we want to make sure what we are doing makes sense (ie the
data are related in some way).</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stack the DataFrames on top of each other</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>vertical_stack <span class="op">=</span> pd.concat([place_sub, place_sub_last10], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># place the DataFrames side by side</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>horizontal_stack <span class="op">=</span> pd.concat([place_sub, place_sub_last10], axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre>
</div>
<div class="section level4">
<h4 id="row-index-values-and-concat">Row Index Values and Concat<a class="anchor" aria-label="anchor" href="#row-index-values-and-concat"></a>
</h4>
<p>Have a look at the <code>vertical_stack</code> dataframe? Notice
anything unusual? The row indexes for the two data frames
<code>place_sub</code> and <code>place_sub_last10</code> have been
repeated. We can reindex the new dataframe using the
<code>reset_index()</code> method.</p>
</div>
<div class="section level3">
<h3 id="writing-out-data-to-csv">Writing Out Data to CSV<a class="anchor" aria-label="anchor" href="#writing-out-data-to-csv"></a>
</h3>
<p>We can use the <code>to_csv</code> command to do export a DataFrame
in CSV format. Note that the code below will by default save the data
into the current working directory. We can save it to a different folder
by adding the foldername and a slash to the file
<code>vertical_stack.to_csv('foldername/out.csv')</code>. We use the
‘index=False’ so that pandas doesn’t include the index number for each
line.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Write DataFrame to CSV</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>vertical_stack.to_csv(<span class="st">'out.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<p>Check out your working directory to make sure the CSV wrote out
properly, and that you can open it! If you want, try to bring it back
into python to make sure it imports properly.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for kicks read our output back into python and make sure all looks good</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>new_output <span class="op">=</span> pd.read_csv(<span class="st">'out.csv'</span>, keep_default_na<span class="op">=</span><span class="va">False</span>, na_values<span class="op">=</span>[<span class="st">""</span>])</span></code></pre>
</div>
<div id="challenge---combine-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---combine-data" class="callout-inner">
<h3 class="callout-title">Challenge - Combine Data<a class="anchor" aria-label="anchor" href="#challenge---combine-data"></a>
</h3>
<div class="callout-content">
<p>In the data folder, there are two catalogue data files:
<code>1635.csv</code> and <code>1640.csv</code>. Read the data into
python and combine the files to make one new data frame.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Solution to Challenge</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a> csv_1 <span class="op">=</span> pd.read_csv(<span class="st">"1635.csv"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a> csv_2 <span class="op">=</span> pd.read_csv(<span class="st">"1640.csv"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a> combined <span class="op">=</span> pd.concat( [csv_1, csv_2], axis<span class="op">=</span><span class="dv">0</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="joining-dataframes"><h2 class="section-heading">Joining DataFrames<a class="anchor" aria-label="anchor" href="#joining-dataframes"></a>
</h2>
<hr class="half-width">
<p>When we concatenated our DataFrames we simply added them to each
other - stacking them either vertically or side by side. Another way to
combine DataFrames is to use columns in each dataset that contain common
values (a common unique id). Combining DataFrames using a common field
is called “joining”. The columns containing the common values are called
“join key(s)”. Joining DataFrames in this way is often useful when one
DataFrame is a “lookup table” containing additional data that we want to
include in the other.</p>
<p>NOTE: This process of joining tables is similar to what we do with
tables in an SQL database.</p>
<p>The <code>places.csv</code> file is table that contains the place and
EEBO id for some titles. When we want to access that information, we can
create a query that joins the additional columns of information to the
author data.</p>
<p>Storing data in this way has many benefits including:</p>
<div class="section level3">
<h3 id="identifying-join-keys">Identifying join keys<a class="anchor" aria-label="anchor" href="#identifying-join-keys"></a>
</h3>
<p>To identify appropriate join keys we first need to know which
field(s) are shared between the files (DataFrames). We might inspect
both DataFrames to identify these columns. If we are lucky, both
DataFrames will have columns with the same name that also contain the
same data. If we are less lucky, we need to identify a
(differently-named) column in each DataFrame that contains the same
information.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> authors_df.columns</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>Index([<span class="st">'TCP'</span>, <span class="st">'Author'</span>], dtype<span class="op">=</span><span class="st">'object'</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> places_df.columns</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>Index([<span class="st">'TCP'</span>, <span class="st">'Place'</span>], dtype<span class="op">=</span><span class="st">'object'</span>)</span></code></pre>
</div>
<p>In our example, the join key is the column containing the identifier,
which is called <code>TCP</code>.</p>
<p>Now that we know the fields with the common TCP ID attributes in each
DataFrame, we are almost ready to join our data. However, since there
are <a href="https://blog.codinghorror.com/a-visual-explanation-of-sql-joins/" class="external-link">different
types of joins</a>, we also need to decide which type of join makes
sense for our analysis.</p>
</div>
<div class="section level3">
<h3 id="inner-joins">Inner joins<a class="anchor" aria-label="anchor" href="#inner-joins"></a>
</h3>
<p>The most common type of join is called an <em>inner join</em>. An
inner join combines two DataFrames based on a join key and returns a new
DataFrame that contains <strong>only</strong> those rows that have
matching values in <em>both</em> of the original DataFrames.</p>
<p>Inner joins yield a DataFrame that contains only rows where the value
being joins exists in BOTH tables. An example of an inner join, adapted
from <a href="https://blog.codinghorror.com/a-visual-explanation-of-sql-joins/" class="external-link">this
page</a> is below:</p>
<figure><img src="https://blog.codinghorror.com/content/fig/uploads/2007/10/6a0120a85dcdae970b012877702708970c-pi.png" alt="Inner join -- courtesy of codinghorror.com" class="figure mx-auto d-block"></figure><p>The pandas function for performing joins is called <code>merge</code>
and an Inner join is the default option:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>merged_inner <span class="op">=</span> pd.merge(left<span class="op">=</span>authors_df,right<span class="op">=</span>places_df, left_on<span class="op">=</span><span class="st">'TCP'</span>, right_on<span class="op">=</span><span class="st">'TCP'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># in this case `species_id` is the only column name in  both dataframes, so if we skippd `left_on`</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># and `right_on` arguments we would still get the same result</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># what's the size of the output data?</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>merged_inner.shape</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>merged_inner</span></code></pre>
</div>
<p><strong>OUTPUT:</strong></p>
<pre><code>      TCP                                             Author             Place
0  A00002                         Aylett, Robert, 1583-1655?            London
1  A00005  Higden, Ranulf, d. 1364. Polycronicon. English...            London
2  A00007             Higden, Ranulf, d. 1364. Polycronicon.            London
3  A00008          Wood, William, fl. 1623, attributed name.  The Netherlands?
4  A00011                                                NaN         Amsterdam</code></pre>
<p>The result of an inner join of <code>authors_df</code> and
<code>places_df</code> is a new DataFrame that contains the combined set
of columns from those tables. It <em>only</em> contains rows that have
two-letter species codes that are the same in both the
<code>authos_df</code> and <code>place_df</code> DataFrames. In other
words, if a row in <code>authors_df</code> has a value of
<code>TCP</code> that does <em>not</em> appear in the <code>TCP</code>
column of <code>TCP</code>, it will not be included in the DataFrame
returned by an inner join. Similarly, if a row in <code>places_df</code>
has a value of <code>TCP</code> that does <em>not</em> appear in the
<code>TCP</code> column of <code>places_df</code>, that row will not be
included in the DataFrame returned by an inner join.</p>
<p>The two DataFrames that we want to join are passed to the
<code>merge</code> function using the <code>left</code> and
<code>right</code> argument. The <code>left_on='TCP'</code> argument
tells <code>merge</code> to use the <code>TCP</code> column as the join
key from <code>places_df</code> (the <code>left</code> DataFrame).
Similarly , the <code>right_on='TCP'</code> argument tells
<code>merge</code> to use the <code>TCP</code> column as the join key
from <code>authors_df</code> (the <code>right</code> DataFrame). For
inner joins, the order of the <code>left</code> and <code>right</code>
arguments does not matter.</p>
<p>The result <code>merged_inner</code> DataFrame contains all of the
columns from <code>authors</code> (TCP, Person) as well as all the
columns from <code>places_df</code> (TCP, Place).</p>
<p>Notice that <code>merged_inner</code> has fewer rows than
<code>place_sub</code>. This is an indication that there were rows in
<code>place_df</code> with value(s) for <code>EEBO</code> that do not
exist as value(s) for <code>EEBO</code> in <code>authors_df</code>.</p>
</div>
<div class="section level3">
<h3 id="left-joins">Left joins<a class="anchor" aria-label="anchor" href="#left-joins"></a>
</h3>
<p>What if we want to add information from <code>cat_sub</code> to
<code>survey_sub</code> without losing any of the information from
<code>survey_sub</code>? In this case, we use a different type of join
called a “left outer join”, or a “left join”.</p>
<p>Like an inner join, a left join uses join keys to combine two
DataFrames. Unlike an inner join, a left join will return <em>all</em>
of the rows from the <code>left</code> DataFrame, even those rows whose
join key(s) do not have values in the <code>right</code> DataFrame. Rows
in the <code>left</code> DataFrame that are missing values for the join
key(s) in the <code>right</code> DataFrame will simply have null (i.e.,
NaN or None) values for those columns in the resulting joined
DataFrame.</p>
<p>Note: a left join will still discard rows from the <code>right</code>
DataFrame that do not have values for the join key(s) in the
<code>left</code> DataFrame.</p>
<figure><img src="https://blog.codinghorror.com/content/fig/uploads/2007/10/6a0120a85dcdae970b01287770273e970c-pi.png" alt="Left Join" class="figure mx-auto d-block"></figure><p>A left join is performed in pandas by calling the same
<code>merge</code> function used for inner join, but using the
<code>how='left'</code> argument:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>merged_left <span class="op">=</span> pd.merge(left<span class="op">=</span>places_df,right<span class="op">=</span>authors_df, how<span class="op">=</span><span class="st">'left'</span>, left_on<span class="op">=</span><span class="st">'TCP'</span>, right_on<span class="op">=</span><span class="st">'TCP'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>merged_left</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>OUTPUT:<span class="op">**</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>      TCP             Place                                             Author</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  A00002            London                         Aylett, Robert, <span class="dv">1583</span><span class="op">-</span><span class="dv">1655</span>?</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  A00005            London  Higden, Ranulf, d. <span class="fl">1364.</span> Polycronicon. English...</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  A00007            London             Higden, Ranulf, d. <span class="fl">1364.</span> Polycronicon.</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  A00008  The Netherlands?          Wood, William, fl. <span class="dv">1623</span>, attributed name.</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  A00011         Amsterdam                                                NaN</span></code></pre>
</div>
<p>The result DataFrame from a left join (<code>merged_left</code>)
looks very much like the result DataFrame from an inner join
(<code>merged_inner</code>) in terms of the columns it contains.
However, unlike <code>merged_inner</code>, <code>merged_left</code>
contains the <strong>same number of rows</strong> as the original
<code>place_sub</code> DataFrame. When we inspect
<code>merged_left</code>, we find there are rows where the information
that should have come from <code>authors_df</code> (i.e.,
<code>Author</code>) is missing (they contain NaN values):</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a> merged_inner[ pd.isnull(merged_inner.Author) ]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>OUTPUT:<span class="op">**</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>        TCP Author      Place</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>    A00011    NaN  Amsterdam</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>    A00014    NaN     London</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>    A00018    NaN   Germany?</span></code></pre>
</div>
<p>These rows are the ones where the value of <code>Author</code> from
<code>authors_df</code> does not occur in <code>places_df</code>.</p>
</div>
<div class="section level3">
<h3 id="other-join-types">Other join types<a class="anchor" aria-label="anchor" href="#other-join-types"></a>
</h3>
<p>The pandas <code>merge</code> function supports two other join
types:</p>
<ul>
<li>Right (outer) join: Invoked by passing <code>how='right'</code> as
an argument. Similar to a left join, except <em>all</em> rows from the
<code>right</code> DataFrame are kept, while rows from the
<code>left</code> DataFrame without matching join key(s) values are
discarded.</li>
<li>Full (outer) join: Invoked by passing <code>how='outer'</code> as an
argument. This join type returns the all pairwise combinations of rows
from both DataFrames; i.e., the result DataFrame will <code>NaN</code>
where data is missing in one of the dataframes. This join type is very
rarely used.</li>
</ul>
</div>
</section><section id="final-challenges"><h2 class="section-heading">Final Challenges<a class="anchor" aria-label="anchor" href="#final-challenges"></a>
</h2>
<hr class="half-width">
<div id="challenge---distributions" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---distributions" class="callout-inner">
<h3 class="callout-title">Challenge - Distributions<a class="anchor" aria-label="anchor" href="#challenge---distributions"></a>
</h3>
<div class="callout-content">
<p>Create a new DataFrame by joining the contents of the
<code>authors.csv</code> and <code>places.csv</code> tables. Calculate
the:</p>
<ol style="list-style-type: decimal">
<li>Number of unique places</li>
<li>Number of books that do not have a known place</li>
<li>Number of books that do not have either a known place or author</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Solution to challenge</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> pd.merge(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                  left<span class="op">=</span>pd.read_csv(<span class="st">"authors.csv"</span>),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                  right<span class="op">=</span>pd.read_csv(<span class="st">"places.csv"</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                  left_on<span class="op">=</span><span class="st">"TCP"</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                  right_on<span class="op">=</span><span class="st">"TCP"</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 1: number of unique places - we can use the .nunique() method</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>num_unique_places <span class="op">=</span> merged[<span class="st">"Place"</span>].nunique()</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 2: we can take advantage of the behaviour that the .count() method</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#         excludes NaN values. So .count() gives us the number that have place</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#         values</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>num_no_place <span class="op">=</span> <span class="bu">len</span>(merged) <span class="op">-</span> merged[<span class="st">"Place"</span>].count()</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Part 3: This needs us to check both columns and combine the resulting masks</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#         Then  we can use the trick of converting boolean to int, and summing, </span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#         to convert the combined mask to a number of True values</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>no_author <span class="op">=</span> pd.isnull(merged[<span class="st">"Author"</span>]) <span class="co"># True where is null</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>no_place <span class="op">=</span> pd.isnull(merged[<span class="st">"Place"</span>])</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>neither <span class="op">=</span> no_author <span class="op">&amp;</span> no_place</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>num_neither <span class="op">=</span> <span class="bu">sum</span>(neither)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="aio-05-loops-and-functions"><p>Content from <a href="05-loops-and-functions.html">Data workflows and automation</a></p>
<hr>
<p>Last updated on 2024-02-13 |
        
        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/05-loops-and-functions.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 90 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Can I automate operations in Python?</li>
<li>What are functions and why should I use them?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe why for loops are used in Python.</li>
<li>Employ for loops to automate data analysis.</li>
<li>Write unique filenames in Python.</li>
<li>Build reusable code in Python.</li>
<li>Write functions using conditional statements (if, then, else).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>So far, we’ve used Python and the pandas library to explore and
manipulate individual datasets by hand, much like we would do in a
spreadsheet. The beauty of using a programming language like Python,
though, comes from the ability to automate data processing through the
use of loops and functions.</p>
<section id="for-loops"><h2 class="section-heading">For loops<a class="anchor" aria-label="anchor" href="#for-loops"></a>
</h2>
<hr class="half-width">
<p>Loops allow us to repeat a workflow (or series of actions) a given
number of times or while some condition is true. We would use a loop to
automatically process data that’s stored in multiple files (daily values
with one file per year, for example). Loops lighten our work load by
performing repeated tasks without our direct involvement and make it
less likely that we’ll introduce errors by making mistakes while
processing each file by hand.</p>
<p>Let’s write a simple for loop that simulates what a kid might see
during a visit to the zoo:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> animals <span class="op">=</span> [<span class="st">'lion'</span>, <span class="st">'tiger'</span>, <span class="st">'crocodile'</span>, <span class="st">'vulture'</span>, <span class="st">'hippo'</span>]</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(animals)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>[<span class="st">'lion'</span>, <span class="st">'tiger'</span>, <span class="st">'crocodile'</span>, <span class="st">'vulture'</span>, <span class="st">'hippo'</span>]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> creature <span class="kw">in</span> animals:</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>...    <span class="bu">print</span>(creature)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>lion</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>tiger</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>crocodile</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>vulture</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>hippo</span></code></pre>
</div>
<p>The line defining the loop must start with <code>for</code> and end
with a colon, and the body of the loop must be indented.</p>
<p>In this example, <code>creature</code> is the loop variable that
takes the value of the next entry in <code>animals</code> every time the
loop goes around. We can call the loop variable anything we like. After
the loop finishes, the loop variable will still exist and will have the
value of the last entry in the collection:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> animals <span class="op">=</span> [<span class="st">'lion'</span>, <span class="st">'tiger'</span>, <span class="st">'crocodile'</span>, <span class="st">'vulture'</span>, <span class="st">'hippo'</span>]</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> creature <span class="kw">in</span> animals:</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>...    <span class="cf">pass</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="st">'The loop variable is now: '</span> <span class="op">+</span> creature)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>The loop variable <span class="kw">is</span> now: hippo</span></code></pre>
</div>
<p>We are not asking python to print the value of the loop variable
anymore, but the for loop still runs and the value of
<code>creature</code> changes on each pass through the loop. The
statement <code>pass</code> in the body of the loop just means “do
nothing”.</p>
<div id="challenge---loops" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---loops" class="callout-inner">
<h3 class="callout-title">Challenge - Loops<a class="anchor" aria-label="anchor" href="#challenge---loops"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>What happens if we don’t include the <code>pass</code>
statement?</p></li>
<li><p>Rewrite the loop so that the animals are separated by commas, not
new lines (Hint: You can concatenate strings using a plus sign. For
example, <code>print(string1 + string2)</code> outputs
‘string1string2’).</p></li>
</ol>
</div>
</div>
</div>
</section><section id="automating-data-processing-using-for-loops"><h2 class="section-heading">Automating data processing using For Loops<a class="anchor" aria-label="anchor" href="#automating-data-processing-using-for-loops"></a>
</h2>
<hr class="half-width">
<p>Suppose that we were working with a much larger set of books. It
might be useful to split them out into smaller groups, e.g., by date of
publication.</p>
<p>Let’s start by making a new directory inside our current working
folder. Python has a built-in library called <code>os</code> for this
sort of operating-system dependent behaviour.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> os</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    os.mkdir(<span class="st">'yearly_files'</span>)</span></code></pre>
</div>
<p>We can check that the folder was created by listing the contents of
the current directory:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> os.listdir()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>[<span class="st">'authors.csv'</span>, <span class="st">'yearly_files'</span>, <span class="st">'places.csv'</span>, <span class="st">'eebo.db'</span>, <span class="st">'eebo.csv'</span>, <span class="st">'1635.csv'</span>, <span class="st">'1640.csv'</span>]</span></code></pre>
</div>
<p>In previous lessons, we saw how to use the library pandas to load the
species data into memory as a DataFrame, how to select a subset of the
data using some criteria, and how to write the DataFrame into a csv
file. Let’s write a script that performs those three steps in sequence
to write out records for the year 1636 as a single csv in the
<code>yearly_files</code> directory</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data into a DataFrame</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>eebo_df <span class="op">=</span> pd.read_csv(<span class="st">'eebo.csv'</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only data for 1636</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>authors1636 <span class="op">=</span> eebo_df[eebo_df.Date <span class="op">==</span> <span class="st">"1636"</span>]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Write the new DataFrame to a csv file</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>authors1636.to_csv(<span class="st">'yearly_files/authors1636.csv'</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Then check that that file now exists:</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>os.listdir(<span class="st">"yearly_files"</span>)</span></code></pre>
</div>
<p>To create yearly data files, we could repeat the last two commands
over and over, once for each year of data. Repeating code is neither
elegant nor practical, and is very likely to introduce errors into your
code. We want to turn what we’ve just written into a loop that repeats
the last two commands for every year in the dataset.</p>
<p>Let’s start by writing a loop that simply prints the names of the
files we want to create - the dataset we are using covers 1977 through
2002, and we’ll create a separate file for each of those years. Listing
the filenames is a good way to confirm that the loop is behaving as we
expect.</p>
<p>We have seen that we can loop over a list of items, so we need a list
of years to loop over. We can get the years in our DataFrame with:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> eebo_df[<span class="st">'Date'</span>]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>      <span class="dv">1625</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="dv">1515</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      <span class="dv">1528</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      <span class="dv">1623</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      <span class="dv">1640</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>      <span class="dv">1623</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    ...    </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="dv">141</span>    <span class="dv">1635</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="dv">142</span>    <span class="dv">1614</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="dv">143</span>    <span class="dv">1589</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="dv">144</span>    <span class="dv">1636</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="dv">145</span>    <span class="dv">1562</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="dv">146</span>    <span class="dv">1533</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="dv">147</span>    <span class="dv">1606</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="dv">148</span>    <span class="dv">1618</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>Name: Date, Length: <span class="dv">149</span>, dtype: int64</span></code></pre>
</div>
<p>but we want only unique years, which we can get using the
<code>unique</code> function which we have already seen.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> eebo_df[<span class="st">'Date'</span>].unique()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>array([<span class="dv">1625</span>, <span class="dv">1515</span>, <span class="dv">1528</span>, <span class="dv">1623</span>, <span class="dv">1640</span>, <span class="dv">1624</span>, <span class="dv">1607</span>, <span class="dv">1558</span>, <span class="dv">1599</span>, <span class="dv">1622</span>, <span class="dv">1613</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1600</span>, <span class="dv">1635</span>, <span class="dv">1569</span>, <span class="dv">1579</span>, <span class="dv">1597</span>, <span class="dv">1538</span>, <span class="dv">1559</span>, <span class="dv">1563</span>, <span class="dv">1577</span>, <span class="dv">1580</span>, <span class="dv">1626</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1631</span>, <span class="dv">1565</span>, <span class="dv">1632</span>, <span class="dv">1571</span>, <span class="dv">1554</span>, <span class="dv">1615</span>, <span class="dv">1549</span>, <span class="dv">1567</span>, <span class="dv">1605</span>, <span class="dv">1636</span>, <span class="dv">1591</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1588</span>, <span class="dv">1619</span>, <span class="dv">1566</span>, <span class="dv">1593</span>, <span class="dv">1547</span>, <span class="dv">1603</span>, <span class="dv">1609</span>, <span class="dv">1589</span>, <span class="dv">1574</span>, <span class="dv">1584</span>, <span class="dv">1630</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1621</span>, <span class="dv">1610</span>, <span class="dv">1542</span>, <span class="dv">1534</span>, <span class="dv">1519</span>, <span class="dv">1550</span>, <span class="dv">1540</span>, <span class="dv">1557</span>, <span class="dv">1606</span>, <span class="dv">1545</span>, <span class="dv">1537</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1532</span>, <span class="dv">1526</span>, <span class="dv">1531</span>, <span class="dv">1533</span>, <span class="dv">1572</span>, <span class="dv">1536</span>, <span class="dv">1529</span>, <span class="dv">1535</span>, <span class="dv">1543</span>, <span class="dv">1586</span>, <span class="dv">1596</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1552</span>, <span class="dv">1608</span>, <span class="dv">1611</span>, <span class="dv">1616</span>, <span class="dv">1581</span>, <span class="dv">1639</span>, <span class="dv">1570</span>, <span class="dv">1564</span>, <span class="dv">1568</span>, <span class="dv">1602</span>, <span class="dv">1618</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1583</span>, <span class="dv">1638</span>, <span class="dv">1592</span>, <span class="dv">1544</span>, <span class="dv">1585</span>, <span class="dv">1614</span>, <span class="dv">1562</span>])</span></code></pre>
</div>
<p>Putting this into our for loop we get</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> year <span class="kw">in</span> eebo_df[<span class="st">'Date'</span>].unique():</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>...    filename <span class="op">=</span> <span class="st">'yearly_files/authors</span><span class="sc">{}</span><span class="st">.csv'</span>.<span class="bu">format</span>(year)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>...    <span class="bu">print</span>(filename)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>yearly_files<span class="op">/</span>authors1625.csv</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>yearly_files<span class="op">/</span>authors1515.csv</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>yearly_files<span class="op">/</span>authors1528.csv</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>yearly_files<span class="op">/</span>authors1623.csv</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>yearly_files<span class="op">/</span>authors1640.csv</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>yearly_files<span class="op">/</span>authors1624.csv</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>yearly_files<span class="op">/</span>authors1607.csv</span></code></pre>
</div>
<p>We can now add the rest of the steps we need to create separate text
files:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data into a DataFrame</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>eebo_df <span class="op">=</span> pd.read_csv(<span class="st">'data/eebo.csv'</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> eebo_df[<span class="st">'Date'</span>].unique():</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Select data for the year</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    publish_year <span class="op">=</span> eebo_df[eebo_df.Date <span class="op">==</span> year]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Write the new DataFrame to a csv file</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    filename <span class="op">=</span> <span class="st">'yearly_files/authors</span><span class="sc">{}</span><span class="st">.csv'</span>.<span class="bu">format</span>(year)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    publish_year.to_csv(filename)</span></code></pre>
</div>
<p>Look inside the <code>yearly_files</code> directory and check a
couple of the files you just created to confirm that everything worked
as expected.</p>
</section><section id="writing-unique-filenames"><h2 class="section-heading">Writing Unique Filenames<a class="anchor" aria-label="anchor" href="#writing-unique-filenames"></a>
</h2>
<hr class="half-width">
<p>Notice that the code above created a unique filename for each
year.</p>
<pre><code>filename = 'yearly_files/authors{}.csv'.format(year)</code></pre>
<p>Let’s break down the parts of this name:</p>
<ul>
<li>The first part is simply some text that specifies the directory to
store our data file in <code>yearly_files/</code> and the first part of
the file name (authors): <code>'yearly_files/authors'</code>
</li>
<li>We want to dynamically insert the value of the year into the
filename. We can do this by indicating a placeholder location inside the
string with <code>{}</code>, and then specifying the value that will go
there with <code>.format(value)</code>
</li>
<li>Finally, we specify a file type with <code>.csv</code>. Since the
<code>.</code> is inside the string, it doesn’t behave the same way as
dot notation in Python commands.</li>
</ul>
<p>Notice the difference between the filename - wrapped in quote marks -
and the variable (<code>year</code>), which is not wrapped in quote
marks. The result looks like <code>'yearly_files/authors1607.csv'</code>
which contains the path to the new filename AND the file name
itself.</p>
<div id="challenge---modifying-loops" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---modifying-loops" class="callout-inner">
<h3 class="callout-title">Challenge - Modifying loops<a class="anchor" aria-label="anchor" href="#challenge---modifying-loops"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Some of the surveys you saved are missing data (they have null
values that show up as NaN - Not A Number - in the DataFrames and do not
show up in the text files). Modify the for loop so that the entries with
null values are not included in the yearly files.</p></li>
<li><p>What happens if there is no data for a year?</p></li>
<li><p>Instead of splitting out the data by years, a colleague wants to
analyse each place separately. How would you write a unique csv file for
each location?</p></li>
</ol>
</div>
</div>
</div>
</section><section id="building-reusable-and-modular-code-with-functions"><h2 class="section-heading">Building reusable and modular code with functions<a class="anchor" aria-label="anchor" href="#building-reusable-and-modular-code-with-functions"></a>
</h2>
<hr class="half-width">
<p>Suppose that separating large data files into individual yearly files
is a task that we frequently have to perform. We could write a
<strong>for loop</strong> like the one above every time we needed to do
it but that would be time consuming and error prone. A more elegant
solution would be to create a reusable tool that performs this task with
minimum input from the user. To do this, we are going to turn the code
we’ve already written into a function.</p>
<p>Functions are reusable, self-contained pieces of code that are called
with a single command. They can be designed to accept arguments as input
and return values, but they don’t need to do either. Variables declared
inside functions only exist while the function is running and if a
variable within the function (a local variable) has the same name as a
variable somewhere else in the code, the local variable hides but
doesn’t overwrite the other.</p>
<p>Every method used in Python (for example, <code>print</code>) is a
function, and the libraries we import (say, <code>pandas</code>) are a
collection of functions. We will only use functions that are housed
within the same code that uses them, but it’s also easy to write
functions that can be used by different programs.</p>
<p>Functions are declared following this general structure:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> this_is_the_function_name(input_argument1, input_argument2):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The body of the function is indented</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""This is the docstring of the function. Wrapped in triple-quotes,</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">    it can span across multiple lines. This is what is shown if you ask</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">    for help about the function like this:</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">    &gt;&gt;&gt; help(this_is_the_function_name)</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This function prints the two arguments to screen</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'The function arguments are:'</span>, input_argument1, input_argument2, <span class="st">'(this is done inside the function!)'</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># And returns their product</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> input_argument1 <span class="op">*</span> input_argument2</span></code></pre>
</div>
<p>The function declaration starts with the word <code>def</code>,
followed by the function name and any arguments in parenthesis, and ends
in a colon. The body of the function is indented just like loops are. If
the function returns something when it is called, it includes a return
statement at the end.</p>
<p>This is how we call the function:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> product_of_inputs <span class="op">=</span> this_is_the_function_name(<span class="dv">2</span>,<span class="dv">5</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>The function arguments are: <span class="dv">2</span> <span class="dv">5</span> (this <span class="kw">is</span> done inside the function<span class="op">!</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="st">'Their product is:'</span>, product_of_inputs, <span class="st">'(this is done outside the function!)'</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>Their product <span class="kw">is</span>: <span class="dv">10</span> (this <span class="kw">is</span> done outside the function<span class="op">!</span>)</span></code></pre>
</div>
<div id="challenge---functions" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---functions" class="callout-inner">
<h3 class="callout-title">Challenge - Functions<a class="anchor" aria-label="anchor" href="#challenge---functions"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Change the values of the arguments in the function and check its
output</li>
<li>Try calling the function by giving it the wrong number of arguments
(not 2) or not assigning the function call to a variable (no
<code>product_of_inputs =</code>)</li>
<li>Declare a variable inside the function and test to see where it
exists (Hint: can you print it from outside the function?)</li>
<li>Explore what happens when a variable both inside and outside the
function have the same name. What happens to the global variable when
you change the value of the local variable?</li>
</ol>
</div>
</div>
</div>
<p>We can now turn our code for saving yearly data files into a
function. There are many different “chunks” of this code that we can
turn into functions, and we can even create functions that call other
functions inside them. Let’s first write a function that separates data
for just one year and saves that data to a file:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> one_year_csv_writer(this_year, all_data):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Writes a csv file for data from a given year.</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">    this_year: int</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">        year for which data is extracted</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">    all_data: pandas Dataframe</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">        DataFrame with multi-year data</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">    None</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Select data for the year</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    texts_year <span class="op">=</span> all_data[all_data.Date <span class="op">==</span> this_year]</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Write the new DataFrame to a csv file</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    filename <span class="op">=</span> <span class="st">'data/yearly_files/function_authors'</span> <span class="op">+</span> <span class="bu">str</span>(this_year) <span class="op">+</span> <span class="st">'.csv'</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    texts_year.to_csv(filename)</span></code></pre>
</div>
<p>The text between the two sets of triple quotes is called a docstring
and contains the documentation for the function. It does nothing when
the function is running and is therefore not necessary, but it is good
practice to include docstrings as a reminder of what the code does.
Docstrings in functions also become part of their ‘official’
documentation:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>one_year_csv_writer?</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>one_year_csv_writer(<span class="st">'1607'</span>,eebo_df)</span></code></pre>
</div>
<p>We changed the root of the name of the csv file so we can distinguish
it from the one we wrote before. Check the <code>yearly_files</code>
directory for the file. Did it do what you expect?</p>
<p>What we really want to do, though, is create files for multiple years
without having to request them one by one. Let’s write another function
that replaces the entire For loop by simply looping through a sequence
of years and repeatedly calling the function we just wrote,
<code>one_year_csv_writer</code>:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> yearly_data_csv_writer(start_year, end_year, all_data):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Writes separate csv files for each year of data.</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">    start_year: int</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">        the first year of data we want</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">    end_year: int</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">        the last year of data we want</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">    all_data: pandas Dataframe</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">        DataFrame with multi-year data</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">    None</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># "end_year" is the last year of data we want to pull, so we loop to end_year+1</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(start_year, end_year<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>        one_year_csv_writer(<span class="bu">str</span>(year), all_data)</span></code></pre>
</div>
<p>Because people will naturally expect that the end year for the files
is the last year with data, the for loop inside the function ends at
<code>end_year + 1</code>. By writing the entire loop into a function,
we’ve made a reusable tool for whenever we need to break a large data
file into yearly files. Because we can specify the first and last year
for which we want files, we can even use this function to create files
for a subset of the years available. This is how we call this
function:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data into a DataFrame</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>eebo_df <span class="op">=</span> pd.read_csv(<span class="st">'data/eebo.csv'</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create csv files</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>yearly_data_csv_writer(<span class="dv">1500</span>, <span class="dv">1650</span>, eebo_df)</span></code></pre>
</div>
<p>BEWARE! If you are using IPython Notebooks and you modify a function,
you MUST re-run that cell in order for the changed function to be
available to the rest of the code. Nothing will visibly happen when you
do this, though, because simply defining a function without
<em>calling</em> it doesn’t produce an output. Any cells that use the
now-changed functions will also have to be re-run for their output to
change.</p>
<div id="challenge--more-functions" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge--more-functions" class="callout-inner">
<h3 class="callout-title">Challenge- More functions<a class="anchor" aria-label="anchor" href="#challenge--more-functions"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Add two arguments to the functions we wrote that take the path of
the directory where the files will be written and the root of the file
name. Create a new set of files with a different name in a different
directory.</li>
<li>How could you use the function <code>yearly_data_csv_writer</code>
to create a csv file for only one year? (Hint: think about the syntax
for <code>range</code>)</li>
<li>Make the functions return a list of the files they have written.
There are many ways you can do this (and you should try them all!):
either of the functions can print to screen, either can use a return
statement to give back numbers or strings to their function call, or you
can use some combination of the two. You could also try using the
<code>os</code> library to list the contents of directories.</li>
<li>Explore what happens when variables are declared inside each of the
functions versus in the main (non-indented) body of your code. What is
the scope of the variables (where are they visible)? What happens when
they have the same name but are given different values?</li>
</ol>
</div>
</div>
</div>
<p>The functions we wrote demand that we give them a value for every
argument. Ideally, we would like these functions to be as flexible and
independent as possible. Let’s modify the function
<code>yearly_data_csv_writer</code> so that the <code>start_year</code>
and <code>end_year</code> default to the full range of the data if they
are not supplied by the user. Arguments can be given default values with
an equal sign in the function declaration. Any arguments in the function
without default values (here, <code>all_data</code>) is a required
argument and MUST come before the argument with default values (which
are optional in the function call).</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> yearly_data_arg_test(all_data, start_year<span class="op">=</span><span class="dv">1000</span>, end_year<span class="op">=</span><span class="dv">2000</span>):</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Test function with default values. Doesn't actually do anything</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">    except return the arguments, to check what they end up as</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">    all_data: pandas Dataframe</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">        DataFrame with multi-year data</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">    start_year: int, optional</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">        the first year of data we want</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">        Default 1000</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">    end_year: int, optional</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">        the last year of data we want</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co">    int</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co">        start_year</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co">    int: </span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co">        end_year</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> start_year, end_year</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (eebo_df, <span class="dv">1600</span>, <span class="dv">1660</span>)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Both optional arguments:</span><span class="ch">\t</span><span class="st">'</span>, start, end)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (eebo_df)</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Default values:</span><span class="ch">\t\t\t</span><span class="st">'</span>, start, end)</span></code></pre>
</div>
<pre><code>Both optional arguments:	1600 1660
Default values:			    1000 2000</code></pre>
<p>The “\t” in the <code>print</code> statements are tabs, used to make
the text align and be easier to read.</p>
<p>But what if our dataset doesn’t start in 1300 and end in 1700? We can
modify the function so that it looks for the start and end years in the
dataset if those dates are not provided:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> yearly_data_arg_test(all_data, start_year<span class="op">=</span><span class="va">None</span>, end_year<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Test function with default values. Doesn't actually do anything</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">    except return the arguments, to check what they end up as</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">    all_data: pandas Dataframe</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">        DataFrame with multi-year data</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">    start_year: int, optional</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">        the first year of data we want.</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co">        Defaults to earliest year in `all_data`</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co">    end_year: int, optional</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co">        the last year of data we want</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co">        Defaults to latest year in `all_data`</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co">    int</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co">        start_year</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co">    int: </span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co">        end_year</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_year <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>        start_year <span class="op">=</span> <span class="bu">min</span>(all_data.Date)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> end_year <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>        end_year <span class="op">=</span> <span class="bu">max</span>(all_data.Date)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> start_year, end_year</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (eebo_df, <span class="st">'1600'</span>, <span class="st">'1660'</span>)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Both optional arguments:</span><span class="ch">\t</span><span class="st">'</span>, start, end)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (eebo_df)</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Default values:</span><span class="ch">\t\t\t</span><span class="st">'</span>, start, end)</span></code></pre>
</div>
<pre><code>Both optional arguments:	1600 1660
Default values:		        1500 1650</code></pre>
<p>The default values of the <code>start_year</code> and
<code>end_year</code> arguments in the function
<code>yearly_data_arg_test</code> are now <code>None</code>. This is a
build-in constant in Python that indicates the absence of a value -
essentially, that the variable exists in the namespace of the function
(the directory of variable names) but that it doesn’t correspond to any
existing object.</p>
<div id="challenge---variables" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---variables" class="callout-inner">
<h3 class="callout-title">Challenge - Variables<a class="anchor" aria-label="anchor" href="#challenge---variables"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>What type of object corresponds to a variable declared as
<code>None</code>? (Hint: create a variable set to <code>None</code> and
use the function <code>type()</code>)</p></li>
<li><p>Compare the behavior of the function
<code>yearly_data_arg_test</code> when the arguments have
<code>None</code> as a default and when they do not have default
values.</p></li>
<li><p>What happens if you only include a value for
<code>start_year</code> in the function call? Can you write the function
call with only a value for <code>end_year</code>? (Hint: think about how
the function must be assigning values to each of the arguments - this is
related to the need to put the arguments without default values before
those with default values in the function definition!)</p></li>
</ol>
</div>
</div>
</div>
</section><section id="if-loops"><h2 class="section-heading">If Loops<a class="anchor" aria-label="anchor" href="#if-loops"></a>
</h2>
<hr class="half-width">
<p>The body of the test function now has two conditional loops (if
loops) that check the values of <code>start_year</code> and
<code>end_year</code>. If loops execute the body of the loop when some
condition is met. They commonly look something like this:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> a<span class="op">&lt;</span><span class="dv">0</span>: <span class="co"># meets first condition?</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if a IS less than zero</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'a is a negative number'</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> a<span class="op">&gt;</span><span class="dv">0</span>: <span class="co"># did not meet first condition. meets second condition?</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if a ISN'T less than zero and IS more than zero</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'a is a positive number'</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>: <span class="co"># met neither condition</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if a ISN'T less than zero and ISN'T more than zero</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'a must be zero!'</span>)</span></code></pre>
</div>
<p>Which would return:</p>
<pre><code>a is a positive number</code></pre>
<p>Change the value of <code>a</code> to see how this function works.
The statement <code>elif</code> means “else if”, and all of the
conditional statements must end in a colon.</p>
<p>The if loops in the function <code>yearly_data_arg_test</code> check
whether there is an object associated with the variable names
<code>start_year</code> and <code>end_year</code>. If those variables
are <code>None</code>, the if loops return the boolean <code>True</code>
and execute whaever is in their body. On the other hand, if the variable
names are associated with some value (they got a number in the function
call), the if loops return <code>False</code> and do not execute. The
opposite conditional statements, which would return <code>True</code> if
the variables were associated with objects (if they had received value
in the function call), would be <code>if start_year</code> and
<code>if end_year</code>.</p>
<p>As we’ve written it so far, the function
<code>yearly_data_arg_test</code> associates values in the function call
with arguments in the function definition just based in their order. If
the function gets only two values in the function call, the first one
will be associated with <code>all_data</code> and the second with
<code>start_year</code>, regardless of what we intended them to be. We
can get around this problem by calling the function using keyword
arguments, where each of the arguments in the function definition is
associated with a keyword and the function call passes values to the
function using these keywords:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (eebo_df)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Default values:</span><span class="ch">\t\t\t</span><span class="st">'</span>, start, end)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (eebo_df, <span class="dv">1600</span>, <span class="dv">1660</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'No keywords:</span><span class="ch">\t\t\t</span><span class="st">'</span>, start, end)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (eebo_df, start_year<span class="op">=</span><span class="dv">1600</span>, end_year<span class="op">=</span><span class="dv">1660</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Both keywords, in order:</span><span class="ch">\t</span><span class="st">'</span>, start, end)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (eebo_df, end_year<span class="op">=</span><span class="dv">1660</span>, start_year<span class="op">=</span><span class="dv">1600</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Both keywords, flipped:</span><span class="ch">\t\t</span><span class="st">'</span>, start, end)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (eebo_df, start_year<span class="op">=</span><span class="dv">1600</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'One keyword, default end:</span><span class="ch">\t</span><span class="st">'</span>, start, end)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>start,end <span class="op">=</span> yearly_data_arg_test (eebo_df, end_year<span class="op">=</span><span class="dv">1660</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'One keyword, default start:</span><span class="ch">\t</span><span class="st">'</span>, start, end)</span></code></pre>
</div>
<pre><code>Default values:			1515 1640
No keywords:			1600 1640
Both keywords, in order:	        1600 1660
Both keywords, flipped:		1600 1660
One keyword, default end:	        1600 1640
One keyword, default start:	        1515 1660</code></pre>
<div id="challenge---modifying-functions" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---modifying-functions" class="callout-inner">
<h3 class="callout-title">Challenge - Modifying functions<a class="anchor" aria-label="anchor" href="#challenge---modifying-functions"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Rewrite the <code>one_year_csv_writer</code> and
<code>yearly_data_csv_writer</code> functions to have keyword arguments
with default values</p></li>
<li><p>Modify the functions so that they don’t create yearly files if
there is no data for a given year and display an alert to the user
(Hint: use conditional statements and if loops to do this. For an extra
challenge, use <code>try</code> statements!)</p></li>
<li><p>The code below checks to see whether a directory exists and
creates one if it doesn’t. Add some code to your function that writes
out the CSV files, to check for a directory to write to.</p></li>
</ol>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="st">'dir_name_here'</span> <span class="kw">in</span> os.listdir(<span class="st">'.'</span>):</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">'Processed directory exists'</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>      os.mkdir(<span class="st">'dir_name_here'</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">'Processed directory created'</span>)</span></code></pre>
</div>
<ol start="4" style="list-style-type: decimal">
<li>The code that you have written so far to loop through the years is
good, however it is not necessarily reproducible with different
datasets. For instance, what happens to the code if we have additional
years of data in our CSV files? Using the tools that you learned in the
previous activities, make a list of all years represented in the data.
Then create a loop to process your data, that begins at the earliest
year and ends at the latest year using that list.</li>
</ol>
<p>HINT: you can create a loop with a list as follows:
<code>for years in year_list:</code></p>
</div>
</div>
</div>
</section></section><section id="aio-06-visualization-ggplot-python"><p>Content from <a href="06-visualization-ggplot-python.html">Plotting with bokeh</a></p>
<hr>
<p>Last updated on 2024-02-13 |
        
        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/06-visualization-ggplot-python.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Can I use Python to create plots?</li>
<li>How can I customize plots generated in Python?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Create a ggplot object</li>
<li>Set universal plot settings</li>
<li>Modify an existing ggplot object</li>
<li>Change the aesthetics of a plot such as colour</li>
<li>Edit the axis labels</li>
<li>Build complex plots using a step-by-step approach</li>
<li>Create scatter plots, box plots, and time series plots</li>
<li>Use the <code>facet_wrap</code> and <code>facet_grid</code> commands
to create a collection of plots splitting the data by a factor
variable</li>
<li>Create customized plot styles to meet their needs</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level5">
<h5 id="disclaimer">Disclaimer<a class="anchor" aria-label="anchor" href="#disclaimer"></a>
</h5>
<p>Python has powerful built-in plotting capabilities such as
<code>matplotlib</code>, but for this exercise, we will be using the <a href="https://docs.bokeh.org/en/latest/" class="external-link"><code>bokeh</code></a> package,
which facilitates the creation of highly-informative plots of structured
data.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>authors_complete <span class="op">=</span> pd.read_csv( <span class="st">'eebo.csv'</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>authors_complete.index.name <span class="op">=</span> <span class="st">'X'</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>authors_complete</span></code></pre>
</div>
<pre><code>        EEBO    VID  ... Page Count             Place</code></pre>
<p>X …<br>
A00002 99850634 15849 … 134 London A00005 99842408 7058 … 302 London
A00007 99844302 9101 … 386 London A00008 99848896 14017 … 14 The
Netherlands? A00011 99837000 1304 … 54 Amsterdam A00012 99853871 19269 …
99 London A00014 33143147 28259 … 1 London A00015 99837006 1310 … 16
 London A00018 99850740 15965 … 26 Germany?</p>
<p>149 rows x 10 columns</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bokeh.plotting <span class="im">import</span> figure, output_file, show</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bokeh.io <span class="im">import</span> output_notebook</span></code></pre>
</div>
</div>
<section id="plotting-with-bokeh"><h2 class="section-heading">Plotting with bokeh<a class="anchor" aria-label="anchor" href="#plotting-with-bokeh"></a>
</h2>
<hr class="half-width">
<p>We will make the same plot using the <code>bokeh</code> package.</p>
<p><code>bokeh</code> is a plotting package that makes it simple to
create complex plots from data in a dataframe. It uses default settings,
which help creating publication quality plots with a minimal amount of
settings and tweaking.</p>
<p>bokeh graphics are built step by step by adding new elements.</p>
<p>To build a bokeh plot we need to:</p>
<ul>
<li><p>bind the plot to a specific data frame using the
<code>data</code> argument</p></li>
<li><p>define figure (<code>figure</code>), by selecting the variables
to be plotted and the variables to define the presentation such as
plotting size, title etc.,</p></li>
</ul>
<p>We also set some notebook settings with a “output_notebook()”
statement to get interactive and exportable plots</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>output_notebook()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> figure(plot_width<span class="op">=</span><span class="dv">400</span>, plot_height<span class="op">=</span><span class="dv">400</span>)</span></code></pre>
</div>
<figure><img src="../fig/figure01.png" alt="png" class="figure mx-auto d-block"></figure><p>We can add simple points to create a scatter plot using circle.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>list_dates <span class="op">=</span> authors_complete[<span class="st">'Date'</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>list_numbers <span class="op">=</span> authors_complete[<span class="st">'Page Count'</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>p.circle(list_dates, list_numbers)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>show(p)</span></code></pre>
</div>
<figure><img src="../fig/figure02.png" alt="png" class="figure mx-auto d-block"></figure></section><section id="building-your-plots"><h2 class="section-heading">Building your plots<a class="anchor" aria-label="anchor" href="#building-your-plots"></a>
</h2>
<hr class="half-width">
<p>We can add extra arguments into circle’s argument.</p>
<p>For comparison, we create a new figure and then add the alpha
argument to circle to change the opacity of the points.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> figure(plot_width<span class="op">=</span><span class="dv">400</span>, plot_height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>p1.circle(list_dates, list_numbers, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>show(p1)</span></code></pre>
</div>
<figure><img src="../fig/figure03.png" alt="png" class="figure mx-auto d-block"></figure><p>We can also add colors for all the points.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> figure(plot_width<span class="op">=</span><span class="dv">400</span>, plot_height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>p2.circle(list_dates, list_numbers, color<span class="op">=</span><span class="st">"blue"</span>, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>show(p2)</span></code></pre>
</div>
<figure><img src="../fig/figure04.png" alt="png" class="figure mx-auto d-block"></figure></section><section id="plotting-time-series-data"><h2 class="section-heading">Plotting time series data<a class="anchor" aria-label="anchor" href="#plotting-time-series-data"></a>
</h2>
<hr class="half-width">
<p>Let’s calculate number of counts per year across the dataset. To do
that we need to group data first and count records within each
group.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>yearly <span class="op">=</span> authors_df[[<span class="st">'Date'</span>,<span class="st">'Place'</span>,<span class="st">'Page Count'</span>]].groupby([<span class="st">'Date'</span>, <span class="st">'Place'</span>]).count().reset_index()</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="op">=</span> figure(plot_width<span class="op">=</span><span class="dv">800</span>, plot_height<span class="op">=</span><span class="dv">250</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>p3.line(yearly[<span class="st">'Date'</span>], yearly[<span class="st">'Page Count'</span>], color<span class="op">=</span><span class="st">'navy'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>show(p3)</span></code></pre>
</div>
<pre><code>year 	place 	count</code></pre>
<p>0 1515 London 1 1 1519 Londini 1 2 1526 London 2 3 1528 London 1 4
1529 Malborow i.e. Antwerp 1 5 1531 London 1</p>
<p>[121 rows x 3 columns]</p>
<p>Timelapse data can be visualised as a line plot with years on x axis
and counts on y axis.</p>
<pre><code><span><span class="va">p3</span> <span class="op">=</span> <span class="fu">figure</span><span class="op">(</span>plot_width<span class="op">=</span><span class="fl">800</span>, plot_height<span class="op">=</span><span class="fl">250</span><span class="op">)</span></span>
<span><span class="fu">p3.line</span><span class="op">(</span><span class="va">yearly</span><span class="op">[</span><span class="st">'Date'</span><span class="op">]</span>, <span class="va">yearly</span><span class="op">[</span><span class="st">'Page Count'</span><span class="op">]</span>, color<span class="op">=</span><span class="st">'navy'</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></span></code></pre>
<figure><img src="../fig/figure05.png" alt="png" class="figure mx-auto d-block"></figure></section><section id="customization"><h2 class="section-heading">Customization<a class="anchor" aria-label="anchor" href="#customization"></a>
</h2>
<hr class="half-width">
<p>Now, let’s add a title to this figure:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bokeh.models <span class="im">import</span> ColumnDataSource, Range1d, LabelSet, Label</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>p4 <span class="op">=</span> figure(title<span class="op">=</span><span class="st">"Plot of Page Counts by Year"</span>, plot_width<span class="op">=</span><span class="dv">400</span>, plot_height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>p4.circle(list_dates, list_numbers)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>p4.xaxis[<span class="dv">0</span>].axis_label <span class="op">=</span> <span class="st">'Date'</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>p4.yaxis[<span class="dv">0</span>].axis_label <span class="op">=</span> <span class="st">'Page Count'</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>show(p4)</span></code></pre>
</div>
<figure><img src="../fig/figure06.png" alt="png" class="figure mx-auto d-block"></figure><p>or we canadd labels to the axes and change the font size for the
labels</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>p5 <span class="op">=</span> figure(title<span class="op">=</span><span class="st">"Plot of Page Counts by Year"</span>, plot_width<span class="op">=</span><span class="dv">400</span>, plot_height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>p5.circle(list_dates, list_numbers)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>p5.xaxis[<span class="dv">0</span>].axis_label <span class="op">=</span> <span class="st">'Date'</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>p5.yaxis[<span class="dv">0</span>].axis_label <span class="op">=</span> <span class="st">'Page Count'</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>p5.xaxis[<span class="dv">0</span>].axis_label_text_font_size <span class="op">=</span> <span class="st">"24pt"</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>show(p5)</span></code></pre>
</div>
<figure><img src="../fig/figure07.png" alt="png" class="figure mx-auto d-block"></figure><p>With all of this information in hand, please take another five
minutes to either improve one of the plots generated in this exercise or
create a beautiful graph of your own.</p>
<p>Here are some ideas:</p>
<ul>
<li>Can you find a way to change its labels?</li>
<li>Use a different color palette.</li>
</ul>
<p>After creating your plot, you can save it to a file as a png
file:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bokeh.io <span class="im">import</span> export_png</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>export_png(p4, filename<span class="op">=</span><span class="st">"plot.png"</span>)</span></code></pre>
</div>
</section></section><section id="aio-07-putting-it-all-together"><p>Content from <a href="07-putting-it-all-together.html">Data Ingest &amp; Visualization - Matplotlib &amp; Pandas</a></p>
<hr>
<p>Last updated on 2024-02-13 |
        
        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/07-putting-it-all-together.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What other tools can I use to create plots apart from ggplot?</li>
<li>Why should I use Python to create plots?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Import the pyplot toolbox to create figures in Python.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="putting-it-all-together"><h2 class="section-heading">Putting it all together<a class="anchor" aria-label="anchor" href="#putting-it-all-together"></a>
</h2>
<hr class="half-width">
<p>Up to this point, we have walked through tasks that are often
involved in handling and processing data using the workshop ready
cleaned<br>
files that we have provided. In this wrap-up exercise, we will perform
many of the same tasks with real data sets. This lesson also covers data
visualization.</p>
<p>As opposed to the previous ones, this lesson does not give
step-by-step directions to each of the tasks. Use the lesson materials
you’ve already gone through as well as the Python documentation to help
you along.</p>
</section><section id="obtain-data"><h2 class="section-heading">1. Obtain data<a class="anchor" aria-label="anchor" href="#obtain-data"></a>
</h2>
<hr class="half-width">
<p>There are many repositories online from which you can obtain data. We
are providing you with one data file to use with these exercises, but
feel free to use any data that is relevant to your research. The file
<code>eebo.csv</code> contains the complete EEBO metadata of books
between 1300-1700. If you’d like to use this dataset, please find it in
the data folder.</p>
</section><section id="clean-up-your-data-and-open-it-using-python-and-pandas"><h2 class="section-heading">2. Clean up your data and open it using Python and Pandas<a class="anchor" aria-label="anchor" href="#clean-up-your-data-and-open-it-using-python-and-pandas"></a>
</h2>
<hr class="half-width">
<p>To begin, import your data file into Python using Pandas. Did it
fail? Your data file probably has a header that Pandas does not
recognize as part of the data table. Remove this header, but do not
simply delete it in a text editor! Use either a shell script or Python
to do this - you wouldn’t want to do it by hand if you had many files to
process.</p>
<p>If you are still having trouble importing the data as a table using
Pandas, check the documentation. You can open the docstring in an
ipython notebook using a question mark. For example:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    pd.read_csv?</span></code></pre>
</div>
<p>Look through the function arguments to see if there is a default
value that is different from what your file requires (Hint: the problem
is most likely the delimiter or separator. Common delimiters are
<code>','</code> for comma, <code>' '</code> for space, and
<code>'\t'</code> for tab).</p>
<p>Create a DataFrame that includes only the values of the data that are
useful to you. In the streamgage file, those values might be the date,
title, terms, and TCP. Convert and joined strings into individual ones.
You can also change the name of the columns in the DataFrame like
this:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Author'</span>] <span class="op">=</span> df[<span class="st">'Author'</span>].<span class="bu">str</span>.split(<span class="st">';'</span>) <span class="co">#split a column in the data frame</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame({<span class="st">'1stcolumn'</span>:[<span class="dv">100</span>,<span class="dv">200</span>], <span class="st">'2ndcolumn'</span>:[<span class="dv">10</span>,<span class="dv">20</span>]}) <span class="co"># this just creates a DataFrame for the example!</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'With the old column names:</span><span class="ch">\n</span><span class="st">'</span>) <span class="co"># the \n makes a new line, so it's easier to see</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    df.columns <span class="op">=</span> [<span class="st">'FirstColumn'</span>,<span class="st">'SecondColumn'</span>] <span class="co"># rename the columns!</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n\n</span><span class="st">With the new column names:</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    With the old column names:</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1</span><span class="er">stcolumn</span>  <span class="dv">2</span><span class="er">ndcolumn</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>        <span class="dv">100</span>         <span class="dv">10</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>        <span class="dv">200</span>         <span class="dv">20</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    With the new column names:</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>       FirstColumn  SecondColumn</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>          <span class="dv">100</span>            <span class="dv">10</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>          <span class="dv">200</span>            <span class="dv">20</span></span></code></pre>
</div>
</section><section id="make-a-line-plot-of-your-data"><h2 class="section-heading">3. Make a line plot of your data<a class="anchor" aria-label="anchor" href="#make-a-line-plot-of-your-data"></a>
</h2>
<hr class="half-width">
<p>Matplotlib is a Python library that can be used to visualize data.
The toolbox <code>matplotlib.pyplot</code> is a collection of functions
that make matplotlib work like MATLAB. In most cases, this is all that
you will need to use, but there are many other useful tools in
matplotlib that you should explore.</p>
<p>We will cover a few basic commands for formatting plots in this
lesson. A great resource for help styling your figures is the matplotlib
gallery (<a href="https://matplotlib.org/gallery.html" class="external-link">http://matplotlib.org/gallery.html</a>),
which includes plots in many different styles and the source code that
creates them. The simplest of plots is the 2 dimensional line plot.
These examples walk through the basic commands for making line plots
using pyplots.</p>
<div id="challenge---lots-of-plots" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---lots-of-plots" class="callout-inner">
<h3 class="callout-title">Challenge - Lots of plots<a class="anchor" aria-label="anchor" href="#challenge---lots-of-plots"></a>
</h3>
<div class="callout-content">
<p>Make a variety of line plots from your data. If you are using the
streamgage data, these could include (1) a hydrograph of the entire
month of September 2013, (2) the discharge record for the week of the
2013 Front Range flood (September 9 through 15), (3) discharge vs. time
of day, for every day in the record in one figure (Hint: use loops to
combine strings and give every line a different style and color), and
(4) minimum, maximum, and mean daily discharge values. Add axis labels,
titles, and legends to your figures. Make at least one figure with
multiple plots using the function <code>subplot()</code>.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="using-pyplot">Using pyplot:<a class="anchor" aria-label="anchor" href="#using-pyplot"></a>
</h3>
<p>First, import the pyplot toolbox:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre>
</div>
<p>By default, matplotlib will create the figure in a separate window.
When using ipython notebooks, we can make figures appear in-line within
the notebook by writing:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span>matplotlib inline</span></code></pre>
</div>
<p>We can start by plotting the values of a list of numbers (matplotlib
can handle many types of numeric data, including numpy arrays and pandas
DataFrames - we are just using a list as an example!):</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>    list_numbers <span class="op">=</span> [<span class="fl">1.5</span>, <span class="dv">4</span>, <span class="fl">2.2</span>, <span class="fl">5.7</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    plt.plot(list_numbers)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre>
</div>
<p>The command <code>plt.show()</code> prompts Python to display the
figure. Without it, it creates an object in memory but doesn’t produce a
visible plot. The ipython notebooks (if using
<code>%matplotlib inline</code>) will automatically show you the figure
even if you don’t write <code>plt.show()</code>, but get in the habit of
including this command!</p>
<p>If you provide the <code>plot()</code> function with only one list of
numbers, it assumes that it is a sequence of y-values and plots them
against their index (the first value in the list is plotted at
<code>x=0</code>, the second at <code>x=1</code>, etc). If the function
<code>plot()</code> receives two lists, it assumes the first one is the
x-values and the second the y-values. The line connecting the points
will follow the list in order:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>    plt.plot([<span class="fl">6.8</span>, <span class="fl">4.3</span>, <span class="fl">3.2</span>, <span class="fl">8.1</span>], list_numbers)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre>
</div>
<p>A third, optional argument in <code>plot()</code> is a string of
characters that indicates the line type and color for the plot. The
default value is a continuous blue line. For example, we can make the
line red (<code>'r'</code>), with circles at every data point
(<code>'o'</code>), and a dot-dash pattern (<code>'-.'</code>). Look
through the matplotlib gallery for more examples.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>    plt.plot([<span class="fl">6.8</span>, <span class="fl">4.3</span>, <span class="fl">3.2</span>, <span class="fl">8.1</span>], list_numbers, <span class="st">'ro-.'</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    plt.axis([<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">6</span>])</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre>
</div>
<p>The command <code>plt.axis()</code> sets the limits of the axes from
a list of <code>[xmin, xmax, ymin, ymax]</code> values (the square
brackets are needed because the argument for the function
<code>axis()</code> is one list of values, not four separate numbers!).
The functions <code>xlabel()</code> and <code>ylabel()</code> will label
the axes, and <code>title()</code> will write a title above the
figure.</p>
<p>A single figure can include multiple lines, and they can be plotted
using the same <code>plt.plot()</code> command by adding more pairs of x
values and y values (and optionally line styles):</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create a numpy array between 0 and 10, with values evenly spaced every 0.5</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> np.arange(<span class="fl">0.</span>, <span class="fl">10.</span>, <span class="fl">0.5</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># red dashes with no symbols, blue squares with a solid line, and green triangles with a dotted line</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    plt.plot(t, t, <span class="st">'r--'</span>, t, t<span class="op">**</span><span class="dv">2</span>, <span class="st">'bs-'</span>, t, t<span class="op">**</span><span class="dv">3</span>, <span class="st">'g^:'</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'This is the x axis'</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'This is the y axis'</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'This is the figure title'</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre>
</div>
<p>We can include a legend by adding the optional keyword argument
<code>label=''</code> in <code>plot()</code>. Caution: We cannot add
labels to multiple lines that are plotted simultaneously by the
<code>plt.plot()</code> command like we did above because Python won’t
know to which line to assign the value of the argument label. Multiple
lines can also be plotted in the same figure by calling the
<code>plot()</code> function several times:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># red dashes with no symbols, blue squares with a solid line, and green triangles with a dotted line</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    plt.plot(t, t, <span class="st">'r--'</span>, label<span class="op">=</span><span class="st">'linear'</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    plt.plot(t, t<span class="op">**</span><span class="dv">2</span>, <span class="st">'bs-'</span>, label<span class="op">=</span><span class="st">'square'</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    plt.plot(t, t<span class="op">**</span><span class="dv">3</span>, <span class="st">'g^:'</span>, label<span class="op">=</span><span class="st">'cubic'</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    plt.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, shadow<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="st">'x-large'</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'This is the x axis'</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'This is the y axis'</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'This is the figure title'</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre>
</div>
<p>The function <code>legend()</code> adds a legend to the figure, and
the optional keyword arguments change its style. By default [typing just
<code>plt.legend()</code>], the legend is on the upper right corner and
has no shadow.</p>
<p>Like MATLAB, pyplot is stateful; it keeps track of the current figure
and plotting area, and any plotting functions are directed to those
axes. To make more than one figure, we use the command
<code>plt.figure()</code> with an increasing figure number inside the
parentheses:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># this is the first figure</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    plt.figure(<span class="dv">1</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    plt.plot(t, t, <span class="st">'r--'</span>, label<span class="op">=</span><span class="st">'linear'</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    plt.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, shadow<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="st">'x-large'</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'This is figure 1'</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># this is a second figure</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    plt.figure(<span class="dv">2</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    plt.plot(t, t<span class="op">**</span><span class="dv">2</span>, <span class="st">'bs-'</span>, label<span class="op">=</span><span class="st">'square'</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    plt.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, shadow<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="st">'x-large'</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'This is figure 2'</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre>
</div>
<p>A single figure can also include multiple plots in a grid pattern.
The <code>subplot()</code> command especifies the number of rows, the
number of columns, and the number of the space in the grid that
particular plot is occupying:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>    plt.figure(<span class="dv">1</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>) <span class="co"># two row, two columns, position 1</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    plt.plot(t, t, <span class="st">'r--'</span>, label<span class="op">=</span><span class="st">'linear'</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>) <span class="co"># two row, two columns, position 2</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    plt.plot(t, t<span class="op">**</span><span class="dv">2</span>, <span class="st">'bs-'</span>, label<span class="op">=</span><span class="st">'square'</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>) <span class="co"># two row, two columns, position 3</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    plt.plot(t, t<span class="op">**</span><span class="dv">3</span>, <span class="st">'g^:'</span>, label<span class="op">=</span><span class="st">'cubic'</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre>
</div>
</div>
</section><section id="make-other-types-of-plots"><h2 class="section-heading">4. Make other types of plots:<a class="anchor" aria-label="anchor" href="#make-other-types-of-plots"></a>
</h2>
<hr class="half-width">
<p>Matplotlib can make many other types of plots in much the same way
that it makes 2 dimensional line plots. Look through the examples in <a href="https://matplotlib.org/users/screenshots.html" class="external-link">http://matplotlib.org/users/screenshots.html</a>
and try a few of them (click on the “Source code” link and copy and
paste into a new cell in ipython notebook or save as a text file with a
<code>.py</code> extension and run in the command line).</p>
<div id="challenge---final-plot" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---final-plot" class="callout-inner">
<h3 class="callout-title">Challenge - Final Plot<a class="anchor" aria-label="anchor" href="#challenge---final-plot"></a>
</h3>
<div class="callout-content">
<p>Display your data using one or more plot types from the example
gallery. Which ones to choose will depend on the content of your own
data file. If you are using the streamgage file, you could make a
histogram of the number of days with a given mean discharge, use bar
plots to display daily discharge statistics, or explore the different
ways matplotlib can handle dates and times for figures.</p>
</div>
</div>
</div>
</section></section><section id="aio-08-working-with-sql"><p>Content from <a href="08-working-with-sql.html">Accessing SQLite Databases Using Python &amp; Pandas</a></p>
<hr>
<p>Last updated on 2024-02-13 |
        
        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/08-working-with-sql.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<section id="python-and-sql"><h2 class="section-heading">Python and SQL<a class="anchor" aria-label="anchor" href="#python-and-sql"></a>
</h2>
<hr class="half-width">
<p>When you open a CSV in python, and assign it to a variable name, you
are using your computers memory to save that variable. Accessing data
from a database like SQL is not only more efficient, but also it allows
you to subset and import only the parts of the data that you need.</p>
<p>In the following lesson, we’ll see some approaches that can be taken
to do so.</p>
<div class="section level3">
<h3 id="the-sqlite3-module">The <code>sqlite3</code> module<a class="anchor" aria-label="anchor" href="#the-sqlite3-module"></a>
</h3>
<p>The <a href="https://docs.python.org/3/library/sqlite3.html" class="external-link">sqlite3</a> module
provides a straightforward interface for interacting with SQLite
databases. A connection object is created using
<code>sqlite3.connect()</code>; the connection must be closed at the end
of the session with the <code>.close()</code> command. While the
connection is open, any interactions with the database require you to
make a cursor object with the <code>.cursor()</code> command. The cursor
is then ready to perform all kinds of operations with
<code>.execute()</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a SQL connection to our SQLite database</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"eebo.db"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the result of a "cursor.execute" can be iterated over by row</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> cur.execute(<span class="st">'SELECT * FROM eebo;'</span>):</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(row)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Be sure to close the connection.</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>con.close()</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="queries">Queries<a class="anchor" aria-label="anchor" href="#queries"></a>
</h3>
<p>One of the most common ways to interact with a database is by
querying: retrieving data based on some search parameters. Use a SELECT
statement string. The query is returned as a single tuple or a tuple of
tuples. Add a WHERE statement to filter your results based on some
parameter.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a SQL connection to our SQLite database</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"eebo.db"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Return all results of query</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>cur.execute(<span class="st">'SELECT Title FROM eebo WHERE Status="Free"'</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>cur.fetchall()</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Return first result of query</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>cur.execute(<span class="st">'SELECT Title FROM eebo WHERE Status="Free"'</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>cur.fetchone()</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Be sure to close the connection.</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>con.close()</span></code></pre>
</div>
</div>
</section><section id="accessing-data-stored-in-sqlite-using-python-and-pandas"><h2 class="section-heading">Accessing data stored in SQLite using Python and Pandas<a class="anchor" aria-label="anchor" href="#accessing-data-stored-in-sqlite-using-python-and-pandas"></a>
</h2>
<hr class="half-width">
<p>Using pandas, we can import results of a SQLite query into a
dataframe. Note that you can use the same SQL commands / syntax that we
used in the SQLite lesson. An example of using pandas together with
sqlite is below:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read sqlite query results into a pandas DataFrame</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"eebo.db"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * from eebo"</span>, con)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># verify that result of SQL query is stored in the dataframe</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.head())</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>con.close()</span></code></pre>
</div>
</section><section id="storing-data-csv-vs-sqlite"><h2 class="section-heading">Storing data: CSV vs SQLite<a class="anchor" aria-label="anchor" href="#storing-data-csv-vs-sqlite"></a>
</h2>
<hr class="half-width">
<p>Storing your data in an SQLite database can provide substantial
performance improvements when reading/writing compared to CSV. The
difference in performance becomes more noticable as the size of the
dataset grows (see for example <a href="https://sebastianraschka.com/Articles/2013_sqlite_database.html#results-and-conclusions" class="external-link">these
benchmarks</a>).</p>
<div id="challenge---sql" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---sql" class="callout-inner">
<h3 class="callout-title">Challenge - SQL<a class="anchor" aria-label="anchor" href="#challenge---sql"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Create a query that contains title data published between 1550 -
1650 that includes book’s Title, Author, and TCP id. How many records
are returned?</li>
</ol>
</div>
</div>
</div>
</section><section id="storing-data-create-new-tables-using-pandas"><h2 class="section-heading">Storing data: Create new tables using Pandas<a class="anchor" aria-label="anchor" href="#storing-data-create-new-tables-using-pandas"></a>
</h2>
<hr class="half-width">
<p>We can also us pandas to create new tables within an SQLite database.
Here, we run we re-do an excercise we did before with CSV files using
our SQLite database. We first read in our survey data, then select only
those survey results for 2002, and then save it out to its own table so
we can work with it on its own later.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"eebo.db"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data into a DataFrame</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>books_df <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * from eebo"</span>, con)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only data for 1640</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>titles1640 <span class="op">=</span> books_df[books_df.Date <span class="op">==</span> <span class="st">'1640'</span>]</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Write the new DataFrame to a new SQLite table</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>titles1640.to_sql(<span class="st">"titles1640"</span>, con, if_exists<span class="op">=</span><span class="st">"replace"</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>con.close()</span></code></pre>
</div>
<div id="challenge---saving-your-work" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---saving-your-work" class="callout-inner">
<h3 class="callout-title">Challenge - Saving your work<a class="anchor" aria-label="anchor" href="#challenge---saving-your-work"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>For each of the challenges in the previous challenge block,
modify your code to save the results to their own tables in the eebo
database.</p></li>
<li><p>What are some of the reasons you might want to save the results
of your queries back into the database? What are some of the reasons you
might avoid doing this.</p></li>
</ol>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/carpentries-incubator/python-humanities-lesson/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries-incubator/python-humanities-lesson/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries-incubator/python-humanities-lesson/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.2" class="external-link">sandpaper (0.16.2)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.3" class="external-link">pegboard (0.7.3)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.1" class="external-link">varnish (1.0.1)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries-incubator.github.io/python-humanities-lesson/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://carpentries-incubator.github.io/python-humanities-lesson/instructor/aio.html",
  "identifier": "https://carpentries-incubator.github.io/python-humanities-lesson/instructor/aio.html",
  "dateCreated": "2024-02-12",
  "dateModified": "2024-02-13",
  "datePublished": "2024-02-13"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

